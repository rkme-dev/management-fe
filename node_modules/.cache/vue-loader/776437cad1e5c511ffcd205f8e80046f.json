{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/purchase-orders/component/CardDownpaymentDetails.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/purchase-orders/component/CardDownpaymentDetails.vue","mtime":1664960080729},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1665368576151},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1665368593779}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgY29tcHV0ZWQsCiAgcmVmLAogIHRvUmVmLAogIHdhdGNoLAp9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpL2Rpc3QvdnVlLWNvbXBvc2l0aW9uLWFwaScKaW1wb3J0IHsKICBtZGlBY2NvdW50T3V0bGluZSwKICBtZGlDYXJ0UGx1cywKICBtZGlDaGV2cm9uRG93biwKICBtZGlDaGV2cm9uVXAsIG1kaUhlbHBDaXJjbGVPdXRsaW5lLCBtZGlMb2NrT3Blbk91dGxpbmUsCiAgbWRpU2hhcmVWYXJpYW50T3V0bGluZSwgbWRpU3Rhck91dGxpbmUsIG1kaVRyZW5kaW5nVXAsCiAgbWRpQ2FyZEFjY291bnRQaG9uZU91dGxpbmUsCiAgbWRpV2FyZWhvdXNlLAogIG1kaUJhbmssCiAgbWRpQmFua1BsdXMsIG1kaUJhbmtUcmFuc2ZlciwKfSBmcm9tICdAbWRpL2pzJwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZScKCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgZGV0YWlsczogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+ICh7fSksCiAgICB9LAogIH0sCiAgc2V0dXAocHJvcHMsIHsgZW1pdCB9KSB7CiAgICBjb25zdCBvcHRpb25zTG9jYWwgPSB0b1JlZihwcm9wcywgJ2RldGFpbHMnKQogICAgY29uc3QgZG9sbGFyUGVyY2VudGFnZVRvUGF5ID0gcmVmKDAuMDApCiAgICBjb25zdCBwZXNvUGVyY2VudGFnZVRvUGF5ID0gcmVmKDAuMDApCiAgICBjb25zdCBlcnJvcnMgPSBjb21wdXRlZCgoKSA9PiBzdG9yZS5nZXR0ZXJzLmVycm9ycykKCiAgICBjb25zdCBjdXJyZW5jeSA9IChjb3VudHJ5ID0gJ1VTRCcpID0+IChuZXcgSW50bC5OdW1iZXJGb3JtYXQoJ2VuLVVTJywgewogICAgICBzdHlsZTogJ2N1cnJlbmN5JywKICAgICAgY3VycmVuY3k6IGNvdW50cnksCiAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMiwKICAgIH0pKQoKICAgIGNvbnN0IGRlYm91bmNlID0gKGZ1bmMsIHRpbWVvdXQgPSA1MDApID0+IHsKICAgICAgbGV0IHRpbWVyCgogICAgICByZXR1cm4gKC4uLmFyZ3MpID0+IHsKICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpCiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGZ1bmMuYXBwbHkodGhpcywgYXJncykKICAgICAgICB9LCB0aW1lb3V0KQogICAgICB9CiAgICB9CgogICAgY29uc3QgbW9uZXlGb3JtYXQgPSBkZWJvdW5jZShmaWVsZCA9PiB7CiAgICAgIGlmIChmaWVsZCkgewogICAgICAgIG9wdGlvbnNMb2NhbC52YWx1ZVtmaWVsZF0gPSBwYXJzZUZsb2F0KG9wdGlvbnNMb2NhbC52YWx1ZVtmaWVsZF0pLnRvRml4ZWQoMikucmVwbGFjZSgvXGQoPz0oXGR7M30pK1wuKS9nLCAnJCYsJykKICAgICAgfQogICAgfSkKCiAgICB3YXRjaChvcHRpb25zTG9jYWwudmFsdWUsIHZhbHVlID0+IHsKICAgICAgaWYgKHZhbHVlLnRvdGFsICYmIHZhbHVlLmNvbnZlcnNpb25fcmF0ZSAmJiB2YWx1ZS5wZXJjZW50YWdlKSB7CiAgICAgICAgY29uc3QgY29udmVyc2lvblJhdGUgPSByZWYoKQogICAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSByZWYoKQogICAgICAgIGNvbnN0IHRvdGFsID0gcmVmKCkKCiAgICAgICAgdG90YWwudmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlLnRvdGFsLnJlcGxhY2UoL1teMC05Ll0vZywgJycpKQogICAgICAgIHBlcmNlbnRhZ2UudmFsdWUgPSAodmFsdWUucGVyY2VudGFnZSAvIDEwMCkudG9GaXhlZCgyKQogICAgICAgIGNvbnZlcnNpb25SYXRlLnZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZS5jb252ZXJzaW9uX3JhdGUpLnRvRml4ZWQoMikKCiAgICAgICAgZG9sbGFyUGVyY2VudGFnZVRvUGF5LnZhbHVlID0gY3VycmVuY3koKS5mb3JtYXQodG90YWwudmFsdWUgKiBwZXJjZW50YWdlLnZhbHVlKQogICAgICAgIHBlc29QZXJjZW50YWdlVG9QYXkudmFsdWUgPSBjdXJyZW5jeSgnUEhQJykuZm9ybWF0KHRvdGFsLnZhbHVlICogcGVyY2VudGFnZS52YWx1ZSAqIGNvbnZlcnNpb25SYXRlLnZhbHVlKQoKICAgICAgICBlbWl0KCdnZXREb3ducGF5bWVudCcsIHsKICAgICAgICAgIHRvdGFsOiB0b3RhbC52YWx1ZSwKICAgICAgICAgIGNvbnZlcnNpb25fcmF0ZTogb3B0aW9uc0xvY2FsLnZhbHVlLmNvbnZlcnNpb25fcmF0ZSwKICAgICAgICAgIGZ4X251bWJlcjogb3B0aW9uc0xvY2FsLnZhbHVlLmZ4X251bWJlciwKICAgICAgICAgIHVzZF9jb252ZXJzaW9uOiBkb2xsYXJQZXJjZW50YWdlVG9QYXkudmFsdWUsCiAgICAgICAgICBwZXNvX2NvbnZlcnNpb246IHBlc29QZXJjZW50YWdlVG9QYXkudmFsdWUsCiAgICAgICAgICBwZXJjZW50YWdlOiBvcHRpb25zTG9jYWwudmFsdWUucGVyY2VudGFnZSwKICAgICAgICAgIGRwX3BlcmNlbnRhZ2U6IG9wdGlvbnNMb2NhbC52YWx1ZS5wZXJjZW50YWdlLAogICAgICAgICAgcGFpZF9hbW91bnQ6IGRvbGxhclBlcmNlbnRhZ2VUb1BheS52YWx1ZS5yZXBsYWNlKCcsJywgJycpLnJlcGxhY2UoJyQnLCAnJyksIC8vIHdlIG1haW50YWluIGRiIHBheW1lbnRzIGluIHVzZCwgcGhwIHRyYW5zYWN0aW9uIGluIHBheW1lbnQgbG9ncwogICAgICAgIH0pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgZW1pdCgnZ2V0RG93bnBheW1lbnQnLCB7CiAgICAgICAgICBjb252ZXJzaW9uX3JhdGU6IG9wdGlvbnNMb2NhbC52YWx1ZS5jb252ZXJzaW9uX3JhdGUsCiAgICAgICAgICB0b3RhbDogdG90YWwudmFsdWUsCiAgICAgICAgICBmeF9udW1iZXI6IG9wdGlvbnNMb2NhbC52YWx1ZS5meF9udW1iZXIsCiAgICAgICAgfSkKICAgICAgICBkb2xsYXJQZXJjZW50YWdlVG9QYXkudmFsdWUgPSAwLjAwCiAgICAgICAgcGVzb1BlcmNlbnRhZ2VUb1BheS52YWx1ZSA9IDAuMDAKICAgICAgfQogICAgfSkKCiAgICAvLwogICAgLy8gY29uc3QgY2FsY3VsYXRlRFBBbW91bnQgPSAoKSA9PiB7CiAgICAvLyAgIGNvbnN0IGZvcm0gPSBvcHRpb25zTG9jYWwudmFsdWUKICAgIC8vICAgZm9ybS50b3RhbCA9IHBhcnNlRmxvYXQoZm9ybS50b3RhbC5yZXBsYWNlKC9bXjAtOS5dL2csICcnKSkKICAgIC8vICAgY29uc3QgcGVyY2VudGFnZSA9IChmb3JtLnBlcmNlbnRhZ2UgLyAxMDApLnRvRml4ZWQoMikKICAgIC8vICAgY29uc3QgY29udmVyc2lvblJhdGUgPSBwYXJzZUZsb2F0KGZvcm0uY29udmVyc2lvbl9yYXRlKS50b0ZpeGVkKDIpCiAgICAvLyAgIGRvbGxhclBlcmNlbnRhZ2VUb1BheS52YWx1ZSA9IGN1cnJlbmN5KCkuZm9ybWF0KGZvcm0udG90YWwgKiBwZXJjZW50YWdlKQogICAgLy8gICBwZXNvUGVyY2VudGFnZVRvUGF5LnZhbHVlID0gY3VycmVuY3koJ1BIUCcpLmZvcm1hdChmb3JtLnRvdGFsICogcGVyY2VudGFnZSAqIGNvbnZlcnNpb25SYXRlKQogICAgLy8gfQoKICAgIHJldHVybiB7CiAgICAgIGVycm9ycywKICAgICAgZG9sbGFyUGVyY2VudGFnZVRvUGF5LAogICAgICBwZXNvUGVyY2VudGFnZVRvUGF5LAogICAgICBtb25leUZvcm1hdCwKICAgICAgaWNvbnM6IHsKICAgICAgICBtZGlDaGV2cm9uVXAsCiAgICAgICAgbWRpQ2hldnJvbkRvd24sCiAgICAgICAgbWRpQ2FydFBsdXMsCiAgICAgICAgbWRpU2hhcmVWYXJpYW50T3V0bGluZSwKICAgICAgICBtZGlMb2NrT3Blbk91dGxpbmUsCiAgICAgICAgbWRpU3Rhck91dGxpbmUsCiAgICAgICAgbWRpQWNjb3VudE91dGxpbmUsCiAgICAgICAgbWRpVHJlbmRpbmdVcCwKICAgICAgICBtZGlIZWxwQ2lyY2xlT3V0bGluZSwKICAgICAgICBtZGlDYXJkQWNjb3VudFBob25lT3V0bGluZSwKICAgICAgICBtZGlXYXJlaG91c2UsCiAgICAgICAgbWRpQmFuaywKICAgICAgICBtZGlCYW5rUGx1cywKICAgICAgICBtZGlCYW5rVHJhbnNmZXIsCiAgICAgIH0sCiAgICB9CiAgfSwKfQo="},{"version":3,"sources":["CardDownpaymentDetails.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CardDownpaymentDetails.vue","sourceRoot":"src/views/pages/purchase-orders/component","sourcesContent":["<template>\n  <div>\n    <v-card\n      class=\"overflow-hidden\"\n      elevation=\"3\"\n    >\n      <v-card-title>Downpayment Details</v-card-title>\n      <v-card-text>\n        <v-row>\n          <v-col\n            cols=\"4\"\n            md=\"6\"\n            class=\"mr-6\"\n          >\n            <v-text-field\n              id=\"firstnameHorizontalIcons\"\n              v-model=\"details.fx_number\"\n              hide-details=\"auto\"\n              :prepend-inner-icon=\"icons.mdiBank\"\n              :error-messages=\"errors.fx_number\"\n              outlined\n              dense\n              label=\"FX Number\"\n            ></v-text-field>\n          </v-col>\n          <v-col\n            class=\"mr-6\"\n            cols=\"4\"\n            md=\"6\"\n          >\n            <v-text-field\n              id=\"firstnameHorizontalIcons\"\n              v-model=\"details.total\"\n              hide-details=\"auto\"\n              prefix=\"$\"\n              outlined\n              dense\n              :error-messages=\"errors.total\"\n              label=\"Total Amount Payable\"\n              @input=\"moneyFormat('total')\"\n            ></v-text-field>\n          </v-col>\n          <v-col\n            cols=\"4\"\n            md=\"6\"\n            class=\"mr-6\"\n          >\n            <v-text-field\n              id=\"firstnameHorizontalIcons\"\n              v-model=\"details.conversion_rate\"\n              hide-details=\"auto\"\n              prefix=\"PHP\"\n              outlined\n              dense\n              label=\"Conversion Rate\"\n              :error-messages=\"errors.conversion_rate\"\n              @input=\"moneyFormat('conversion_rate')\"\n            ></v-text-field>\n          </v-col>\n          <v-col\n            cols=\"4\"\n            md=\"6\"\n            class=\"mr-6 mb-6\"\n          >\n            <v-select\n              v-model=\"details.percentage\"\n              outlined\n              label=\"Downpayment Percentage\"\n              item-text=\"text\"\n              item-value=\"percentage\"\n              dense\n              prefix=\"%\"\n              :error-messages=\"errors.dp_percentage\"\n              :items=\"[{text:10,value:0.1},20,30,40,50,60,70,80,90,100]\"\n            ></v-select>\n          </v-col>\n          <v-col\n            cols=\"4\"\n            md=\"6\"\n          >\n            <v-divider />\n\n            <v-text-field\n              id=\"firstnameHorizontalIcons\"\n              v-model=\"dollarPercentageToPay\"\n              readonly\n              hide-details=\"auto\"\n              prefix=\"PHP\"\n              dense\n              label=\"Amount in USD\"\n            ></v-text-field>\n          </v-col>\n          <v-col\n            cols=\"4\"\n            md=\"6\"\n          >\n            <v-divider />\n            <v-text-field\n              id=\"firstnameHorizontalIcons\"\n              v-model=\"pesoPercentageToPay\"\n              readonly\n              hide-details=\"auto\"\n              prefix=\"PHP\"\n              dense\n              label=\"Amount in PHP\"\n            ></v-text-field>\n          </v-col>\n        </v-row>\n      </v-card-text>\n    </v-card>\n  </div>\n</template>\n\n<script>\nimport {\n  computed,\n  ref,\n  toRef,\n  watch,\n} from '@vue/composition-api/dist/vue-composition-api'\nimport {\n  mdiAccountOutline,\n  mdiCartPlus,\n  mdiChevronDown,\n  mdiChevronUp, mdiHelpCircleOutline, mdiLockOpenOutline,\n  mdiShareVariantOutline, mdiStarOutline, mdiTrendingUp,\n  mdiCardAccountPhoneOutline,\n  mdiWarehouse,\n  mdiBank,\n  mdiBankPlus, mdiBankTransfer,\n} from '@mdi/js'\nimport store from '@/store'\n\nexport default {\n  props: {\n    details: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  setup(props, { emit }) {\n    const optionsLocal = toRef(props, 'details')\n    const dollarPercentageToPay = ref(0.00)\n    const pesoPercentageToPay = ref(0.00)\n    const errors = computed(() => store.getters.errors)\n\n    const currency = (country = 'USD') => (new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: country,\n      minimumFractionDigits: 2,\n    }))\n\n    const debounce = (func, timeout = 500) => {\n      let timer\n\n      return (...args) => {\n        clearTimeout(timer)\n        timer = setTimeout(() => {\n          func.apply(this, args)\n        }, timeout)\n      }\n    }\n\n    const moneyFormat = debounce(field => {\n      if (field) {\n        optionsLocal.value[field] = parseFloat(optionsLocal.value[field]).toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$&,')\n      }\n    })\n\n    watch(optionsLocal.value, value => {\n      if (value.total && value.conversion_rate && value.percentage) {\n        const conversionRate = ref()\n        const percentage = ref()\n        const total = ref()\n\n        total.value = parseFloat(value.total.replace(/[^0-9.]/g, ''))\n        percentage.value = (value.percentage / 100).toFixed(2)\n        conversionRate.value = parseFloat(value.conversion_rate).toFixed(2)\n\n        dollarPercentageToPay.value = currency().format(total.value * percentage.value)\n        pesoPercentageToPay.value = currency('PHP').format(total.value * percentage.value * conversionRate.value)\n\n        emit('getDownpayment', {\n          total: total.value,\n          conversion_rate: optionsLocal.value.conversion_rate,\n          fx_number: optionsLocal.value.fx_number,\n          usd_conversion: dollarPercentageToPay.value,\n          peso_conversion: pesoPercentageToPay.value,\n          percentage: optionsLocal.value.percentage,\n          dp_percentage: optionsLocal.value.percentage,\n          paid_amount: dollarPercentageToPay.value.replace(',', '').replace('$', ''), // we maintain db payments in usd, php transaction in payment logs\n        })\n      } else {\n        emit('getDownpayment', {\n          conversion_rate: optionsLocal.value.conversion_rate,\n          total: total.value,\n          fx_number: optionsLocal.value.fx_number,\n        })\n        dollarPercentageToPay.value = 0.00\n        pesoPercentageToPay.value = 0.00\n      }\n    })\n\n    //\n    // const calculateDPAmount = () => {\n    //   const form = optionsLocal.value\n    //   form.total = parseFloat(form.total.replace(/[^0-9.]/g, ''))\n    //   const percentage = (form.percentage / 100).toFixed(2)\n    //   const conversionRate = parseFloat(form.conversion_rate).toFixed(2)\n    //   dollarPercentageToPay.value = currency().format(form.total * percentage)\n    //   pesoPercentageToPay.value = currency('PHP').format(form.total * percentage * conversionRate)\n    // }\n\n    return {\n      errors,\n      dollarPercentageToPay,\n      pesoPercentageToPay,\n      moneyFormat,\n      icons: {\n        mdiChevronUp,\n        mdiChevronDown,\n        mdiCartPlus,\n        mdiShareVariantOutline,\n        mdiLockOpenOutline,\n        mdiStarOutline,\n        mdiAccountOutline,\n        mdiTrendingUp,\n        mdiHelpCircleOutline,\n        mdiCardAccountPhoneOutline,\n        mdiWarehouse,\n        mdiBank,\n        mdiBankPlus,\n        mdiBankTransfer,\n      },\n    }\n  },\n}\n</script>\n"]}]}