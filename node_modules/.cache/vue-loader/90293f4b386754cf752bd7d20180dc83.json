{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/purchase-orders/purchase-order/PurchaseOrderApprove.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/purchase-orders/purchase-order/PurchaseOrderApprove.vue","mtime":1660821026945},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1650363919730}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgY29tcHV0ZWQsIHJlZiwgd2F0Y2gsIG9uTW91bnRlZCwKfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaScKaW1wb3J0IHJvdXRlciBmcm9tICdAL3JvdXRlcicKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUnCmltcG9ydCB7CiAgQVBQUk9WRV9QVVJDSEFTRV9PUkRFUiwgR0VUX1BST0RVQ1RTLCBHRVRfU1VQUExJRVIsIEdFVF9TVVBQTElFUlMsCn0gZnJvbSAnQC9zdG9yZS9hY3Rpb25zLnR5cGUnCmltcG9ydCBQdXJjaGFzZU9yZGVyc1NlcnZpY2UgZnJvbSAnQC91dGlscy9zZXJ2aWNlcy9wdXJjaGFzZS1vcmRlcnMuc2VydmljZScKaW1wb3J0IHsgbWRpQm9va0luZm9ybWF0aW9uVmFyaWFudCwgbWRpQ2xpcGJvYXJkTGlzdE91dGxpbmUgfSBmcm9tICdAbWRpL2pzJwppbXBvcnQgUHVyY2hhc2VPcmRlckxvZ3MgZnJvbSAnQC92aWV3cy9wYWdlcy9wdXJjaGFzZS1vcmRlcnMvcHVyY2hhc2Utb3JkZXIvbG9ncy9QdXJjaGFzZU9yZGVyTG9ncycKaW1wb3J0IENhcmRTdXBwbGllckRldGFpbHMgZnJvbSAiQC92aWV3cy9wYWdlcy9wdXJjaGFzZS1vcmRlcnMvY29tcG9uZW50L0NhcmRTdXBwbGllckRldGFpbHMudnVlIgoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIFB1cmNoYXNlT3JkZXJMb2dzLAogICAgQ2FyZFN1cHBsaWVyRGV0YWlscywKICB9LAogIHNldHVwKCkgewogICAgY29uc3QgeyBpZCB9ID0gcm91dGVyLmhpc3RvcnkuY3VycmVudC5wYXJhbXMKICAgIGNvbnN0IGVycm9ycyA9IGNvbXB1dGVkKCgpID0+IHN0b3JlLmdldHRlcnMuZXJyb3JzKQogICAgY29uc3QgcHJvZHVjdHMgPSBjb21wdXRlZCgoKSA9PiBzdG9yZS5nZXR0ZXJzLnByb2R1Y3RzKQogICAgY29uc3Qgc3VwcGxpZXJzID0gY29tcHV0ZWQoKCkgPT4gc3RvcmUuZ2V0dGVycy5zdXBwbGllcnMpCiAgICBjb25zdCBzZWxlY3RlZEl0ZW1UcmlnZ2VyID0gcmVmKFtdKQogICAgY29uc3Qgb3JkZXJJdGVtcyA9IHJlZihbXSkKICAgIGNvbnN0IHNob3dBbGVydCA9IHJlZihmYWxzZSkKICAgIGNvbnN0IG9wdGlvbnNMb2NhbCA9IHJlZih7CiAgICAgIGZ4X251bWJlcjogJycsCiAgICAgIGV0YTogJycsCiAgICAgIGl0ZW1zOiB7fSwKICAgICAgdG90YWw6IDAsCiAgICAgIHBlcmNlbnRhZ2U6IDAsCiAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgcGFpZF9hbW91bnQ6ICcnLAogICAgICBiYWxhbmNlOiAwLAogICAgfSkKICAgIGNvbnN0IHRhYiA9IHJlZignJykKICAgIGNvbnN0IGRvbGxhclBlcmNlbnRhZ2VUb1BheSA9IHJlZignJykKICAgIGNvbnN0IHBlc29QZXJjZW50YWdlVG9QYXkgPSByZWYoJycpCiAgICBjb25zdCBiYWxhbmNlID0gcmVmKCcnKQoKICAgIGNvbnN0IHRlc3QgPSAoKSA9PiB7CiAgICAgIGNvbnN0IGZvcm0gPSBvcHRpb25zTG9jYWwudmFsdWUKICAgICAgY29uc3QgcGVyY2VudGFnZSA9IChmb3JtLnBlcmNlbnRhZ2UgLyAxMDApLnRvRml4ZWQoMikKICAgICAgY29uc3QgY29udmVyc2lvblJhdGUgPSBwYXJzZUZsb2F0KGZvcm0uY29udmVyc2lvbl9yYXRlKS50b0ZpeGVkKDIpCiAgICAgIGRvbGxhclBlcmNlbnRhZ2VUb1BheS52YWx1ZSA9IChmb3JtLnRvdGFsICogcGVyY2VudGFnZSkudG9GaXhlZCgyKS50b1N0cmluZygpCiAgICAgIHBlc29QZXJjZW50YWdlVG9QYXkudmFsdWUgPSAoZm9ybS50b3RhbCAqIHBlcmNlbnRhZ2UgKiBjb252ZXJzaW9uUmF0ZSkudG9GaXhlZCgyKS50b1N0cmluZygpCiAgICAgIGJhbGFuY2UudmFsdWUgPSAoZm9ybS50b3RhbCAtIHBhcnNlRmxvYXQoZm9ybS5wYWlkX2Ftb3VudCkpLnRvRml4ZWQoMikudG9TdHJpbmcoKQogICAgfQoKICAgIG9uTW91bnRlZChhc3luYyAoKSA9PiB7CiAgICAgIGF3YWl0IFB1cmNoYXNlT3JkZXJzU2VydmljZS5maW5kKGlkKQogICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gcmVzcG9uc2UuZGF0YQogICAgICAgICAgb3B0aW9uc0xvY2FsLnZhbHVlID0gewogICAgICAgICAgICBkZXNjcmlwdGlvbjogZGF0YS5vcmRlci5kZXNjcmlwdGlvbiwKICAgICAgICAgICAgZnhfbnVtYmVyOiBkYXRhLm9yZGVyLmZ4X2lkLAogICAgICAgICAgICBpdGVtczoge30sCiAgICAgICAgICB9CgogICAgICAgICAgb3JkZXJJdGVtcy52YWx1ZSA9IGRhdGEuaXRlbXMKICAgICAgICB9KQogICAgfSkKCiAgICBzdG9yZS5kaXNwYXRjaChHRVRfUFJPRFVDVFMpCiAgICBzdG9yZS5kaXNwYXRjaChHRVRfU1VQUExJRVJTKQoKICAgIGNvbnN0IGdvQmFjayA9ICgpID0+IHsKICAgICAgcm91dGVyLnB1c2goJy9wdXJjaGFzZS1vcmRlcnMnKQogICAgfQoKICAgIHdhdGNoKAogICAgICBvcHRpb25zTG9jYWwsCiAgICAgICgpID0+IHsKICAgICAgICBpZiAob3B0aW9uc0xvY2FsLnZhbHVlLnRvdGFsICYmIG9wdGlvbnNMb2NhbC52YWx1ZS5wYWlkX2Ftb3VudCkgewogICAgICAgICAgb3B0aW9uc0xvY2FsLnZhbHVlLmJhbGFuY2UgPSBwYXJzZUZsb2F0KG9wdGlvbnNMb2NhbC52YWx1ZS50b3RhbCkgLSBwYXJzZUZsb2F0KG9wdGlvbnNMb2NhbC52YWx1ZS5wYWlkX2Ftb3VudCkKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHsgaW1tZWRpYXRlOiB0cnVlIH0sCiAgICApCgogICAgY29uc3QgcmVzb2x2ZUZvcm1TdWNjZXNzID0gKCkgPT4gewogICAgICBzaG93QWxlcnQudmFsdWUgPSB0cnVlCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGdvQmFjaygpCiAgICAgIH0sIDUwMDApCiAgICB9CgogICAgY29uc3Qgc2F2ZSA9ICgpID0+IHsKICAgICAgY29uc3QgY3VycmVudEZvcm0gPSBvcHRpb25zTG9jYWwudmFsdWUKICAgICAgY3VycmVudEZvcm0uaWQgPSByb3V0ZXIuaGlzdG9yeS5jdXJyZW50LnBhcmFtcy5pZAogICAgICBjdXJyZW50Rm9ybS51c2RfY29udmVyc2lvbiA9IGRvbGxhclBlcmNlbnRhZ2VUb1BheS52YWx1ZQogICAgICBjdXJyZW50Rm9ybS5wZXNvX2NvbnZlcnNpb24gPSBwZXNvUGVyY2VudGFnZVRvUGF5LnZhbHVlCiAgICAgIGN1cnJlbnRGb3JtLmRwX3BlcmNlbnRhZ2UgPSBjdXJyZW50Rm9ybS5wZXJjZW50YWdlCiAgICAgIGN1cnJlbnRGb3JtLnBhaWRfYW1vdW50ID0gZG9sbGFyUGVyY2VudGFnZVRvUGF5LnZhbHVlIC8vIHdlIG1haW50YWluIGRiIHBheW1lbnRzIGluIHVzZCwgcGhwIHRyYW5zYWN0aW9uIGluIHBheW1lbnQgbG9ncwogICAgICBjdXJyZW50Rm9ybS5zdXBwbGllcl9pZCA9IGN1cnJlbnRGb3JtLnN1cHBsaWVyLmlkCgogICAgICBzdG9yZS5kaXNwYXRjaChBUFBST1ZFX1BVUkNIQVNFX09SREVSLCBjdXJyZW50Rm9ybSkudGhlbihkYXRhID0+IHsKICAgICAgICBpZiAoZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICByZXNvbHZlRm9ybVN1Y2Nlc3MoKQogICAgICAgIH0KICAgICAgfSkKICAgIH0KCiAgICAvLyB0YWJzCiAgICBjb25zdCB0YWJzID0gWwogICAgICB7IHRpdGxlOiAnUHVyY2hhc2UgT3JkZXIgSW5mb3JtYXRpb24nLCBpY29uOiBtZGlCb29rSW5mb3JtYXRpb25WYXJpYW50IH0sCiAgICAgIHsgdGl0bGU6ICdQdXJjaGFzZSBPcmRlciBMb2dzJywgaWNvbjogbWRpQ2xpcGJvYXJkTGlzdE91dGxpbmUgfSwKICAgIF0KCiAgICByZXR1cm4gewogICAgICBiYWxhbmNlLAogICAgICBpZCwKICAgICAgdGFiLAogICAgICB0YWJzLAogICAgICBzZWxlY3RlZEl0ZW1UcmlnZ2VyLAogICAgICBwcm9kdWN0cywKICAgICAgb3B0aW9uc0xvY2FsLAogICAgICBnb0JhY2ssCiAgICAgIHNhdmUsCiAgICAgIHNob3dBbGVydCwKICAgICAgZXJyb3JzLAogICAgICBvcmRlckl0ZW1zLAogICAgICB0ZXN0LAogICAgICBkb2xsYXJQZXJjZW50YWdlVG9QYXksCiAgICAgIHBlc29QZXJjZW50YWdlVG9QYXksCiAgICAgIHN1cHBsaWVycwogICAgfQogIH0KICAsCn0K"},{"version":3,"sources":["PurchaseOrderApprove.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PurchaseOrderApprove.vue","sourceRoot":"src/views/pages/purchase-orders/purchase-order","sourcesContent":["<template>\n  <v-card\n    flat\n    class=\"pa-3 mt-2\"\n  >\n    <!-- tabs -->\n    <v-tabs\n      v-model=\"tab\"\n      show-arrows\n    >\n      <v-tab\n        v-for=\"tab in tabs\"\n        :key=\"tab.icon\"\n        class=\"text-md\"\n      >\n        <v-icon\n          size=\"30\"\n          class=\"me-3\"\n        >\n          {{ tab.icon }}\n        </v-icon>\n        <span>{{ tab.title }}</span>\n      </v-tab>\n    </v-tabs>\n\n    <!-- tabs item -->\n    <v-tabs-items v-model=\"tab\">\n      <v-tab-item>\n        <v-alert\n          v-show=\"showAlert\"\n          dense\n          text\n          type=\"success\"\n        >\n          Successfully <strong>approved</strong> a purchase order. You will be automatically\n          redirected in a bit.\n        </v-alert>\n        <v-form class=\"multi-col-validation\">\n          <v-card-text class=\"pt-5\">\n            <v-row>\n              <v-col\n                cols=\"12\"\n                class=\"mt-6\"\n              >\n                <h2 class=\"font-weight-black mb-2 text-uppercase\">Requested Raw Material Information</h2>\n                <v-divider />\n              </v-col>\n              <v-col cols=\"6\">\n                <v-img\n                  class=\"mt-10\"\n                  aspect-ratio=\"1.7\"\n                  max-height=\"250\"\n                  contain\n                  lazy-src=\"https://picsum.photos/id/11/10/6\"\n                  src=\"https://picsum.photos/id/11/500/300\"\n                ></v-img>\n              </v-col>\n              <v-col cols=\"6\">\n                <v-card-text class=\"mt-10\">\n                  <v-subheader class=\"font-weight-black\">\n                    Raw Materials In Stock\n                  </v-subheader>\n                  <v-simple-table\n                    fixed-header\n                  >\n                    <template v-slot:default>\n                      <thead>\n                        <tr>\n                          <th class=\"text-left\">\n                            Name\n                          </th>\n                          <th class=\"text-left\">\n                            Quantity In Stock\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        <tr\n                          v-for=\"item in products\"\n                          :key=\"item.name\"\n                        >\n                          <td>{{ item.name }}</td>\n                          <td>{{ item.in_stock }}</td>\n                        </tr>\n                      </tbody>\n                    </template>\n                  </v-simple-table>\n                </v-card-text>\n              </v-col>\n\n              <v-col cols=\"12\">\n                <v-select\n                  v-model=\"optionsLocal.supplier\"\n                  label=\"Select a Supplier\"\n                  item-text=\"name\"\n                  item-value=\"id\"\n                  dense\n                  :items=\"suppliers\"\n                  return-object\n                ></v-select>\n              </v-col>\n              <v-col cols=\"12\" class=\"mt-10\" v-show=\"optionsLocal.supplier\">\n                <card-supplier-details\n                  title=\"Supplier Details\"\n                  :details=\"optionsLocal.supplier\"\n                />\n              </v-col>\n              <v-col cols=\"12\">\n                <v-card-text class=\"px-0\">\n                  <v-simple-table\n                    fixed-header\n                  >\n                    <template v-slot:default>\n                      <thead>\n                      <tr>\n                        <th class=\"text-left\">\n                          Material Name\n                        </th>\n                        <th class=\"text-left\">\n                          Requested Quantity\n                        </th>\n                      </tr>\n                      </thead>\n                      <tbody>\n                      <tr\n                        v-for=\"(item, key) in orderItems\"\n                        :key=\"item.name\"\n                      >\n                        <td>{{ item.name }}</td>\n                        <td>{{ item.quantity }}</td>\n                      </tr>\n                      </tbody>\n                    </template>\n                  </v-simple-table>\n                </v-card-text>\n              </v-col>\n              <v-col\n                cols=\"7\"\n              >\n                <v-textarea\n                  v-model=\"optionsLocal.description\"\n                  outlined\n                  dense\n                  label=\"Description\"\n                  :readonly=\"mode === 'show'\"\n                  hide-details=\"auto\"\n                  :persistent-placeholder=\"mode === 'show'\"\n                ></v-textarea>\n              </v-col>\n              <v-col cols=\"12\" class=\" mb-6\">\n                <h2 class=\"font-weight-black mt-10 mb-2 text-uppercase\">Downpayment Details</h2>\n                <v-divider />\n              </v-col>\n              <v-col\n                cols=\"7\"\n              >\n                <v-text-field\n                  v-model=\"optionsLocal.fx_number\"\n                  outlined\n                  dense\n                  label=\"FX Number\"\n                  :readonly=\"mode === 'show'\"\n                  hide-details=\"auto\"\n                  :persistent-placeholder=\"mode === 'show'\"\n                ></v-text-field>\n              </v-col>\n              <v-col cols=\"6\">\n                <v-text-field\n                  v-model=\"optionsLocal.total\"\n                  prefix=\"$\"\n                  outlined\n                  dense\n                  label=\"Total Amount Payable\"\n                  :readonly=\"mode === 'show'\"\n                  hide-details=\"auto\"\n                  :persistent-placeholder=\"mode === 'show'\"\n                >\n                </v-text-field>\n              </v-col>\n              <v-col cols=\"6\">\n                <v-text-field\n                  v-model=\"optionsLocal.conversion_rate\"\n                  prefix=\"PHP\"\n                  outlined\n                  dense\n                  label=\"Current Conversion Rate\"\n                  :readonly=\"mode === 'show'\"\n                  hide-details=\"auto\"\n                ></v-text-field>\n              </v-col>\n              <v-col cols=\"3\">\n                <v-select\n                  v-model=\"optionsLocal.percentage\"\n                  label=\"Downpayment\"\n                  item-text=\"text\"\n                  item-value=\"percentage\"\n                  dense\n                  prefix=\"%\"\n                  :items=\"[{text:10,value:0.1},20,30,40,50,60,70,80,90,100]\"\n                  @input=\"test\"\n                ></v-select>\n              </v-col>\n              <v-col cols=\"3\">\n                <span>Converted Amount To Pay</span>\n              </v-col>\n              <v-col\n                cols=\"2\"\n              >\n                <span class=\"font-weight-black text-base\">Amount in USD ${{ dollarPercentageToPay }}</span>\n              </v-col>\n              <v-col\n                cols=\"2\"\n              >\n                <span class=\"font-weight-black text-base\">Amount in PHP P{{ pesoPercentageToPay }}</span>\n              </v-col>\n              <v-col\n                cols=\"6\"\n              >\n                <v-text-field\n                  v-model=\"pesoPercentageToPay\"\n                  prefix=\"PHP\"\n                  outlined\n                  dense\n                  label=\"DP Paid Amount\"\n                  :readonly=\"mode === 'show'\"\n                  hide-details=\"auto\"\n                  :persistent-placeholder=\"mode === 'show'\"\n                ></v-text-field>\n              </v-col>\n            </v-row>\n          </v-card-text>\n\n          <v-card-text class=\"mt-10\">\n            <v-btn\n              outlined\n              class=\"mr-3\"\n              color=\"primary\"\n              @click=\"save\"\n            >\n              Approve\n            </v-btn>\n            <v-btn\n              outlined\n              type=\"reset\"\n              @click.prevent=\"goBack\"\n            >\n              Back to List\n            </v-btn>\n          </v-card-text>\n        </v-form>\n      </v-tab-item>\n      <v-tab-item>\n        <purchase-order-logs :order-id=\"id\"></purchase-order-logs>\n      </v-tab-item>\n    </v-tabs-items>\n  </v-card>\n</template>\n\n<script>\nimport {\n  computed, ref, watch, onMounted,\n} from '@vue/composition-api'\nimport router from '@/router'\nimport store from '@/store'\nimport {\n  APPROVE_PURCHASE_ORDER, GET_PRODUCTS, GET_SUPPLIER, GET_SUPPLIERS,\n} from '@/store/actions.type'\nimport PurchaseOrdersService from '@/utils/services/purchase-orders.service'\nimport { mdiBookInformationVariant, mdiClipboardListOutline } from '@mdi/js'\nimport PurchaseOrderLogs from '@/views/pages/purchase-orders/purchase-order/logs/PurchaseOrderLogs'\nimport CardSupplierDetails from \"@/views/pages/purchase-orders/component/CardSupplierDetails.vue\"\n\nexport default {\n  components: {\n    PurchaseOrderLogs,\n    CardSupplierDetails,\n  },\n  setup() {\n    const { id } = router.history.current.params\n    const errors = computed(() => store.getters.errors)\n    const products = computed(() => store.getters.products)\n    const suppliers = computed(() => store.getters.suppliers)\n    const selectedItemTrigger = ref([])\n    const orderItems = ref([])\n    const showAlert = ref(false)\n    const optionsLocal = ref({\n      fx_number: '',\n      eta: '',\n      items: {},\n      total: 0,\n      percentage: 0,\n      description: '',\n      paid_amount: '',\n      balance: 0,\n    })\n    const tab = ref('')\n    const dollarPercentageToPay = ref('')\n    const pesoPercentageToPay = ref('')\n    const balance = ref('')\n\n    const test = () => {\n      const form = optionsLocal.value\n      const percentage = (form.percentage / 100).toFixed(2)\n      const conversionRate = parseFloat(form.conversion_rate).toFixed(2)\n      dollarPercentageToPay.value = (form.total * percentage).toFixed(2).toString()\n      pesoPercentageToPay.value = (form.total * percentage * conversionRate).toFixed(2).toString()\n      balance.value = (form.total - parseFloat(form.paid_amount)).toFixed(2).toString()\n    }\n\n    onMounted(async () => {\n      await PurchaseOrdersService.find(id)\n        .then(response => {\n          const { data } = response.data\n          optionsLocal.value = {\n            description: data.order.description,\n            fx_number: data.order.fx_id,\n            items: {},\n          }\n\n          orderItems.value = data.items\n        })\n    })\n\n    store.dispatch(GET_PRODUCTS)\n    store.dispatch(GET_SUPPLIERS)\n\n    const goBack = () => {\n      router.push('/purchase-orders')\n    }\n\n    watch(\n      optionsLocal,\n      () => {\n        if (optionsLocal.value.total && optionsLocal.value.paid_amount) {\n          optionsLocal.value.balance = parseFloat(optionsLocal.value.total) - parseFloat(optionsLocal.value.paid_amount)\n        }\n      },\n      { immediate: true },\n    )\n\n    const resolveFormSuccess = () => {\n      showAlert.value = true\n      setTimeout(() => {\n        goBack()\n      }, 5000)\n    }\n\n    const save = () => {\n      const currentForm = optionsLocal.value\n      currentForm.id = router.history.current.params.id\n      currentForm.usd_conversion = dollarPercentageToPay.value\n      currentForm.peso_conversion = pesoPercentageToPay.value\n      currentForm.dp_percentage = currentForm.percentage\n      currentForm.paid_amount = dollarPercentageToPay.value // we maintain db payments in usd, php transaction in payment logs\n      currentForm.supplier_id = currentForm.supplier.id\n\n      store.dispatch(APPROVE_PURCHASE_ORDER, currentForm).then(data => {\n        if (data != null) {\n          resolveFormSuccess()\n        }\n      })\n    }\n\n    // tabs\n    const tabs = [\n      { title: 'Purchase Order Information', icon: mdiBookInformationVariant },\n      { title: 'Purchase Order Logs', icon: mdiClipboardListOutline },\n    ]\n\n    return {\n      balance,\n      id,\n      tab,\n      tabs,\n      selectedItemTrigger,\n      products,\n      optionsLocal,\n      goBack,\n      save,\n      showAlert,\n      errors,\n      orderItems,\n      test,\n      dollarPercentageToPay,\n      pesoPercentageToPay,\n      suppliers\n    }\n  }\n  ,\n}\n</script>\n"]}]}