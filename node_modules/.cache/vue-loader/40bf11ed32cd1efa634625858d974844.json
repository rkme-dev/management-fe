{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/user-access-management/access-levels/AccessLevelForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/user-access-management/access-levels/AccessLevelForm.vue","mtime":1658553711124},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1650363919730}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgd2F0Y2gsCiAgb25Nb3VudGVkLAogIHJlZiwKICB0b1JlZiwgY29tcHV0ZWQsCn0gZnJvbSAnQHZ1ZS9jb21wb3NpdGlvbi1hcGkvZGlzdC92dWUtY29tcG9zaXRpb24tYXBpJwppbXBvcnQgewogIG1kaUFjY291bnRPdXRsaW5lLAogIG1kaUNlbGxwaG9uZSwKICBtZGlFbWFpbE91dGxpbmUsCiAgbWRpTG9ja091dGxpbmUsCn0gZnJvbSAnQG1kaS9qcycKaW1wb3J0IFVzZXJBY2Nlc3NNYW5hZ2VtZW50U2VydmljZSBmcm9tICdAL3NlcnZpY2UvVXNlckFjY2Vzc01hbmFnZW1lbnRTZXJ2aWNlJwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZScKCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgYWNjZXNzTGV2ZWw6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6IG51bGwsCiAgICB9LAogIH0sCiAgc2V0dXAocHJvcHMsIHsgZW1pdCB9KSB7CiAgICBjb25zdCBlcnJvcnMgPSBjb21wdXRlZCgoKSA9PiBzdG9yZS5zdGF0ZS5Vc2VyQWNjZXNzTWFuYWdlbWVudFN0b3JlLmVycm9ycykKICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgVXNlckFjY2Vzc01hbmFnZW1lbnRTZXJ2aWNlKCkKICAgIGNvbnN0IHJvbGVPcHRpb25zID0gcmVmKFtdKQogICAgY29uc3QgYWNjZXNzTGV2ZWxEYXRhID0gdG9SZWYocHJvcHMsICdhY2Nlc3NMZXZlbCcpCiAgICBjb25zdCBhYmlsaXRpZXNPcHRpb25zID0gcmVmKFtdKQogICAgY29uc3QgYWJpbGl0aWVzU2VsZWN0ZWQgPSByZWYoW10pCgogICAgd2F0Y2goYWNjZXNzTGV2ZWxEYXRhLCB2YWx1ZSA9PiB7CiAgICAgIGFiaWxpdGllc1NlbGVjdGVkLnZhbHVlID0gdmFsdWUuYWJpbGl0aWVzLm1hcChhYmlsaXR5ID0+IGFiaWxpdHkuaWQpCiAgICAgIGFjY2Vzc0xldmVsRGF0YS52YWx1ZS5yb2xlX2lkcyA9IHZhbHVlLnJvbGVzPy5tYXAocm9sZSA9PiByb2xlLmlkKQogICAgfSkKCiAgICBvbk1vdW50ZWQoYXN5bmMgKCkgPT4gewogICAgICBhd2FpdCBzZXJ2aWNlLmdldEFiaWxpdGllcyh0cnVlKQogICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGFiaWxpdGllc09wdGlvbnMudmFsdWUgPSByZXNwb25zZS5kYXRhCiAgICAgICAgICBhYmlsaXRpZXNTZWxlY3RlZC52YWx1ZSA9IGFjY2Vzc0xldmVsRGF0YS52YWx1ZS5hYmlsaXRpZXM/Lm1hcChhYmlsaXR5ID0+IGFiaWxpdHkuaWQpCiAgICAgICAgfSkKCiAgICAgIGF3YWl0IHNlcnZpY2UuZ2V0Um9sZXModHJ1ZSkKICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICByb2xlT3B0aW9ucy52YWx1ZSA9IHJlc3BvbnNlLmRhdGEKICAgICAgICAgIGFjY2Vzc0xldmVsRGF0YS52YWx1ZS5yb2xlX2lkcyA9IGFjY2Vzc0xldmVsRGF0YS52YWx1ZS5yb2xlcz8ubWFwKHJvbGUgPT4gcm9sZS5pZCkKICAgICAgICB9KQogICAgfSkKCiAgICBjb25zdCBjYW5jZWwgPSAoKSA9PiB7CiAgICAgIGVtaXQoJ2NsaWNrZWQnLCBmYWxzZSkKICAgIH0KCiAgICBjb25zdCBzdWJtaXQgPSAoKSA9PiB7CiAgICAgIGlmIChhY2Nlc3NMZXZlbERhdGEudmFsdWUuaWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnN0IGZvcm1EYXRhID0gewogICAgICAgICAgYWJpbGl0eV9pZHM6IGFiaWxpdGllc1NlbGVjdGVkLnZhbHVlLAogICAgICAgICAgbmFtZTogYWNjZXNzTGV2ZWxEYXRhLnZhbHVlLm5hbWUsCiAgICAgICAgICByb2xlX2lkczogYWNjZXNzTGV2ZWxEYXRhLnZhbHVlLnJvbGVfaWRzID8/IFtdLAogICAgICAgIH0KICAgICAgICBzdG9yZS5kaXNwYXRjaCgnVXNlckFjY2Vzc01hbmFnZW1lbnRTdG9yZS9jcmVhdGVBY2Nlc3NMZXZlbCcsIGZvcm1EYXRhKS50aGVuKAogICAgICAgICAgcmVzcG9uc2UgPT4gewogICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBlbWl0KCdjbGlja2VkJywgewogICAgICAgICAgICAgICAgYWxlcnRUeXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBhbGVydE1lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgQ3JlYXRlZCBBY2Nlc3MgTGV2ZWwuJywKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICkKICAgICAgfSBlbHNlIHsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgnVXNlckFjY2Vzc01hbmFnZW1lbnRTdG9yZS91cGRhdGVBY2Nlc3NMZXZlbCcsIHsKICAgICAgICAgIGlkOiBhY2Nlc3NMZXZlbERhdGEudmFsdWUuaWQsCiAgICAgICAgICBhYmlsaXR5X2lkczogYWJpbGl0aWVzU2VsZWN0ZWQudmFsdWUsCiAgICAgICAgICByb2xlX2lkczogYWNjZXNzTGV2ZWxEYXRhLnZhbHVlLnJvbGVfaWRzLAogICAgICAgIH0pLnRoZW4oCiAgICAgICAgICAoKSA9PiB7CiAgICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCdVc2VyQWNjZXNzTWFuYWdlbWVudFN0b3JlL2dldEFjY2Vzc0xldmVscycpCiAgICAgICAgICAgIGVtaXQoJ2NsaWNrZWQnLCBmYWxzZSkKICAgICAgICAgIH0sCiAgICAgICAgKQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgYWJpbGl0aWVzU2VsZWN0ZWQsCiAgICAgIGFiaWxpdGllc09wdGlvbnMsCiAgICAgIGNhbmNlbCwKICAgICAgZXJyb3JzLAogICAgICBpY29uczogewogICAgICAgIG1kaUFjY291bnRPdXRsaW5lLAogICAgICAgIG1kaUVtYWlsT3V0bGluZSwKICAgICAgICBtZGlDZWxscGhvbmUsCiAgICAgICAgbWRpTG9ja091dGxpbmUsCiAgICAgIH0sCiAgICAgIGFjY2Vzc0xldmVsRGF0YSwKICAgICAgcm9sZU9wdGlvbnMsCiAgICAgIHN1Ym1pdCwKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgfSwKICBtZXRob2RzOiB7CiAgfSwKfQo="},{"version":3,"sources":["AccessLevelForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AccessLevelForm.vue","sourceRoot":"src/views/pages/user-access-management/access-levels","sourcesContent":["<template>\n  <v-form>\n    <v-row>\n      <v-col\n        cols=\"12\"\n        md=\"3\"\n      >\n        <label for=\"firstnameHorizontalIcons\">Access Level Name</label>\n      </v-col>\n\n      <v-col\n        cols=\"12\"\n        md=\"9\"\n      >\n        <v-text-field\n          id=\"firstnameHorizontalIcons\"\n          v-model=\"accessLevelData.name\"\n          hide-details=\"auto\"\n          :prepend-inner-icon=\"icons.mdiAccountOutline\"\n          outlined\n          dense\n          :error-messages=\"errors.name\"\n          placeholder=\"Access Level Name\"\n        ></v-text-field>\n      </v-col>\n      <v-col\n        cols=\"12\"\n        md=\"3\"\n      >\n        <label for=\"firstnameHorizontalIcons\">Roles</label>\n      </v-col>\n      <v-col\n        cols=\"12\"\n        md=\"9\"\n      >\n        <v-select\n          v-model=\"accessLevelData.role_ids\"\n          dense\n          outlined\n          multiple\n          :prepend-inner-icon=\"icons.mdiHumanEdit\"\n          item-text=\"title\"\n          item-value=\"id\"\n          label=\"Role\"\n          :items=\"roleOptions\"\n          hide-details=\"auto\"\n        ></v-select>\n      </v-col>\n      <v-col\n        cols=\"12\"\n        md=\"3\"\n      >\n        <label for=\"firstnameHorizontalIcons\">Abilities</label>\n      </v-col>\n\n      <v-col\n        cols=\"12\"\n        md=\"9\"\n      >\n        <v-treeview\n          v-model=\"abilitiesSelected\"\n          selectable\n          selected-color=\"primary\"\n          item-disabled=\"locked\"\n          item-key=\"id\"\n          item-text=\"name\"\n          item-children=\"abilities\"\n          hide-details=\"auto\"\n          :items=\"abilitiesOptions\"\n        ></v-treeview>\n      </v-col>\n      <v-col\n        offset-md=\"3\"\n        cols=\"12\"\n      >\n        <v-btn\n          color=\"primary\"\n          @click=\"submit\"\n        >\n          Submit\n        </v-btn>\n        <v-btn\n          type=\"reset\"\n          outlined\n          class=\"mx-2\"\n          @click=\"cancel\"\n        >\n          Cancel\n        </v-btn>\n      </v-col>\n    </v-row>\n  </v-form>\n</template>\n\n<script>\nimport {\n  watch,\n  onMounted,\n  ref,\n  toRef, computed,\n} from '@vue/composition-api/dist/vue-composition-api'\nimport {\n  mdiAccountOutline,\n  mdiCellphone,\n  mdiEmailOutline,\n  mdiLockOutline,\n} from '@mdi/js'\nimport UserAccessManagementService from '@/service/UserAccessManagementService'\nimport store from '@/store'\n\nexport default {\n  props: {\n    accessLevel: {\n      type: Object,\n      required: false,\n      default: null,\n    },\n  },\n  setup(props, { emit }) {\n    const errors = computed(() => store.state.UserAccessManagementStore.errors)\n    const service = new UserAccessManagementService()\n    const roleOptions = ref([])\n    const accessLevelData = toRef(props, 'accessLevel')\n    const abilitiesOptions = ref([])\n    const abilitiesSelected = ref([])\n\n    watch(accessLevelData, value => {\n      abilitiesSelected.value = value.abilities.map(ability => ability.id)\n      accessLevelData.value.role_ids = value.roles?.map(role => role.id)\n    })\n\n    onMounted(async () => {\n      await service.getAbilities(true)\n        .then(response => {\n          abilitiesOptions.value = response.data\n          abilitiesSelected.value = accessLevelData.value.abilities?.map(ability => ability.id)\n        })\n\n      await service.getRoles(true)\n        .then(response => {\n          roleOptions.value = response.data\n          accessLevelData.value.role_ids = accessLevelData.value.roles?.map(role => role.id)\n        })\n    })\n\n    const cancel = () => {\n      emit('clicked', false)\n    }\n\n    const submit = () => {\n      if (accessLevelData.value.id === undefined) {\n        const formData = {\n          ability_ids: abilitiesSelected.value,\n          name: accessLevelData.value.name,\n          role_ids: accessLevelData.value.role_ids ?? [],\n        }\n        store.dispatch('UserAccessManagementStore/createAccessLevel', formData).then(\n          response => {\n            if (response.status === undefined) {\n              emit('clicked', {\n                alertType: 'success',\n                alertMessage: 'Successfully Created Access Level.',\n              })\n            }\n          },\n        )\n      } else {\n        store.dispatch('UserAccessManagementStore/updateAccessLevel', {\n          id: accessLevelData.value.id,\n          ability_ids: abilitiesSelected.value,\n          role_ids: accessLevelData.value.role_ids,\n        }).then(\n          () => {\n            store.dispatch('UserAccessManagementStore/getAccessLevels')\n            emit('clicked', false)\n          },\n        )\n      }\n    }\n\n    return {\n      abilitiesSelected,\n      abilitiesOptions,\n      cancel,\n      errors,\n      icons: {\n        mdiAccountOutline,\n        mdiEmailOutline,\n        mdiCellphone,\n        mdiLockOutline,\n      },\n      accessLevelData,\n      roleOptions,\n      submit,\n    }\n  },\n  computed: {\n  },\n  methods: {\n  },\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}