{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/warehouse/raw-materials-release/components/RawMaterialAddSelector.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/warehouse/raw-materials-release/components/RawMaterialAddSelector.vue","mtime":1659925293627},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1650363919730}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHJlZiwgd2F0Y2gsIHRvUmVmIH0gZnJvbSAnQHZ1ZS9jb21wb3NpdGlvbi1hcGkvZGlzdC92dWUtY29tcG9zaXRpb24tYXBpJwoKaW1wb3J0IHsKICBtZGlNaW51cywKICBtZGlQbHVzLAp9IGZyb20gJ0BtZGkvanMnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1Jhd01hdGVyaWFsQWRkU2VsZWN0b3InLAogIHByb3BzOiB7CiAgICBwcm9kdWN0RGF0YTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgfSwKICAgIGl0ZW1OdW1iZXI6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAwLAogICAgfSwKICAgIHByb2R1Y3REcm9wZG93bjogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gW10sCiAgICB9LAogIH0sCiAgc2V0dXAocHJvcHMsIHsgZW1pdCB9KSB7CiAgICBjb25zdCBwcm9kdWN0ID0gdG9SZWYocHJvcHMsICdwcm9kdWN0RGF0YScpCiAgICBjb25zdCBwcm9kdWN0U2VsZWN0aW9uID0gcmVmKFtdKQogICAgY29uc3QgaXNEaXNhYmxlZCA9IHJlZih0cnVlKQoKICAgIGlmIChwcm9kdWN0LnZhbHVlLmlkKSB7CiAgICAgIGlzRGlzYWJsZWQudmFsdWUgPSBmYWxzZQogICAgfQoKICAgIGNvbnN0IGhhbmRsZUlzTnVtYmVyID0gZXZ0ID0+IHsKICAgICAgY29uc3QgZXZlbnQgPSAoZXZ0KSB8fCB3aW5kb3cuZXZlbnQKICAgICAgY29uc3QgY29kZSA9IChldmVudC53aGljaCkgPyBldmVudC53aGljaCA6IGV2ZW50LmtleUNvZGUKCiAgICAgIGlmICgoY29kZSA+IDMxICYmIChjb2RlIDwgNDggfHwgY29kZSA+IDU3KSkgJiYgY29kZSAhPT0gNDYpIHsKICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpCgogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZQogICAgfQoKICAgIGNvbnN0IGFkZFByb2R1Y3RSb3cgPSAoKSA9PiB7CiAgICAgIGVtaXQoJ2FkZFByb2R1Y3RSb3cnLCBwcm9kdWN0KQogICAgfQoKICAgIGNvbnN0IHJlbW92ZVByb2R1Y3QgPSAoKSA9PiB7CiAgICAgIGVtaXQoJ3JlbW92ZVByb2R1Y3RSb3cnLCBwcm9wcy5pdGVtTnVtYmVyKQogICAgfQoKICAgIC8vIGRpc2FibGUgaXRlbSBpbiBkcm9wZG93bgogICAgY29uc3QgaGFuZGxlRGlzYWJsZWRJdGVtID0gaXRlbSA9PiAoISFpdGVtLmRpc2FibGVkKQoKICAgIHdhdGNoKAogICAgICBwcm9kdWN0LAogICAgICAoKSA9PiB7CiAgICAgICAgaWYgKHByb2R1Y3QudmFsdWUuaWQpIHsKICAgICAgICAgIGlzRGlzYWJsZWQudmFsdWUgPSBmYWxzZQogICAgICAgIH0KICAgICAgfSwKICAgICkKCiAgICB3YXRjaCgKICAgICAgcHJvZHVjdC52YWx1ZSwKICAgICAgKCkgPT4gewogICAgICAgIGlmIChwcm9kdWN0LnZhbHVlLnRvdGFsX2JveGVzKSB7CiAgICAgICAgICBjb25zdCBwcm9kdWN0TW9kZWwgPSBwcm9wcy5wcm9kdWN0RHJvcGRvd24uZmluZChpdGVtID0+IGl0ZW0uaWQgPT09IHByb2R1Y3QudmFsdWUucHJvZHVjdF9pZCkKCiAgICAgICAgICBwcm9kdWN0LnZhbHVlLnRvdGFsX3BpZWNlcyA9IHBhcnNlSW50KHByb2R1Y3QudmFsdWUudG90YWxfYm94ZXMsIDApICogcHJvZHVjdE1vZGVsPy5pdGVtc19wZXJfYm94CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvZHVjdC52YWx1ZS5wcm9kdWN0X2lkICYmIHByb2R1Y3QudmFsdWUudG90YWxfcGllY2VzICYmIHByb2R1Y3QudmFsdWUudG90YWxfYm94ZXMpIHsKICAgICAgICAgIGlzRGlzYWJsZWQudmFsdWUgPSBmYWxzZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpc0Rpc2FibGVkLnZhbHVlID0gdHJ1ZQogICAgICAgIH0KICAgICAgfSwKICAgICkKCiAgICByZXR1cm4gewogICAgICBhZGRQcm9kdWN0Um93LAogICAgICByZW1vdmVQcm9kdWN0LAogICAgICBwcm9kdWN0LAogICAgICBwcm9kdWN0U2VsZWN0aW9uLAogICAgICBpc0Rpc2FibGVkLAogICAgICBpY29uczogewogICAgICAgIG1kaVBsdXMsCiAgICAgICAgbWRpTWludXMsCiAgICAgIH0sCiAgICAgIGhhbmRsZUlzTnVtYmVyLAogICAgICBoYW5kbGVEaXNhYmxlZEl0ZW0sCiAgICB9CiAgfSwKfQo="},{"version":3,"sources":["RawMaterialAddSelector.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RawMaterialAddSelector.vue","sourceRoot":"src/views/pages/warehouse/raw-materials-release/components","sourcesContent":["<template>\n  <v-card>\n    <v-row>\n      <v-col cols=\"3\">\n        <v-select\n          v-model=\"product.product_id\"\n          label=\"Raw Material\"\n          item-text=\"name\"\n          item-value=\"id\"\n          dense\n          :items=\"productDropdown\"\n          :item-disabled=\"handleDisabledItem\"\n        ></v-select>\n      </v-col>\n\n      <v-col cols=\"3\">\n        <v-text-field\n          v-model=\"product.total_boxes\"\n          label=\"Total Boxes\"\n          hide-details=\"auto\"\n          dense\n          @keypress=\"handleIsNumber\"\n        />\n      </v-col>\n\n      <v-col cols=\"3\">\n        <v-text-field\n          v-model=\"product.total_pieces\"\n          disabled\n          label=\"Total Pieces\"\n          hide-details=\"auto\"\n          dense\n          @keypress=\"handleIsNumber\"\n        />\n      </v-col>\n\n      <v-col cols=\"1\">\n        <v-btn\n          v-show=\"itemNumber !== productDropdown.length\"\n          class=\"mx-2\"\n          x-small\n          fab\n          :disabled=\"isDisabled\"\n          @click=\"addProductRow\"\n        >\n          <v-icon dark>\n            {{ icons.mdiPlus }}\n          </v-icon>\n        </v-btn>\n      </v-col>\n      <v-col cols=\"1\">\n        <v-btn\n          class=\"mx-2\"\n          x-small\n          fab\n          @click=\"removeProduct\"\n        >\n          <v-icon dark>\n            {{ icons.mdiMinus }}\n          </v-icon>\n        </v-btn>\n      </v-col>\n    </v-row>\n  </v-card>\n</template>\n\n<script>\nimport { ref, watch, toRef } from '@vue/composition-api/dist/vue-composition-api'\n\nimport {\n  mdiMinus,\n  mdiPlus,\n} from '@mdi/js'\n\nexport default {\n  name: 'RawMaterialAddSelector',\n  props: {\n    productData: {\n      type: Object,\n      required: true,\n    },\n    itemNumber: {\n      type: Number,\n      default: 0,\n    },\n    productDropdown: {\n      type: Array,\n      default: () => [],\n    },\n  },\n  setup(props, { emit }) {\n    const product = toRef(props, 'productData')\n    const productSelection = ref([])\n    const isDisabled = ref(true)\n\n    if (product.value.id) {\n      isDisabled.value = false\n    }\n\n    const handleIsNumber = evt => {\n      const event = (evt) || window.event\n      const code = (event.which) ? event.which : event.keyCode\n\n      if ((code > 31 && (code < 48 || code > 57)) && code !== 46) {\n        event.preventDefault()\n\n        return false\n      }\n\n      return true\n    }\n\n    const addProductRow = () => {\n      emit('addProductRow', product)\n    }\n\n    const removeProduct = () => {\n      emit('removeProductRow', props.itemNumber)\n    }\n\n    // disable item in dropdown\n    const handleDisabledItem = item => (!!item.disabled)\n\n    watch(\n      product,\n      () => {\n        if (product.value.id) {\n          isDisabled.value = false\n        }\n      },\n    )\n\n    watch(\n      product.value,\n      () => {\n        if (product.value.total_boxes) {\n          const productModel = props.productDropdown.find(item => item.id === product.value.product_id)\n\n          product.value.total_pieces = parseInt(product.value.total_boxes, 0) * productModel?.items_per_box\n        }\n\n        if (product.value.product_id && product.value.total_pieces && product.value.total_boxes) {\n          isDisabled.value = false\n        } else {\n          isDisabled.value = true\n        }\n      },\n    )\n\n    return {\n      addProductRow,\n      removeProduct,\n      product,\n      productSelection,\n      isDisabled,\n      icons: {\n        mdiPlus,\n        mdiMinus,\n      },\n      handleIsNumber,\n      handleDisabledItem,\n    }\n  },\n}\n</script>\n"]}]}