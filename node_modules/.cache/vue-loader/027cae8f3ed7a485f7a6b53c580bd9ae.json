{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/logistics/trip-tickets/SalesDrItemSelection.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/logistics/trip-tickets/SalesDrItemSelection.vue","mtime":1665298457912},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1665368576151},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1665368593779}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJwppbXBvcnQgewogIHdhdGNoLAogIG9uTW91bnRlZCwKICBjb21wdXRlZCwKICB0b1JlZiwKICByZWYsCn0gZnJvbSAnQHZ1ZS9jb21wb3NpdGlvbi1hcGkvZGlzdC92dWUtY29tcG9zaXRpb24tYXBpJwppbXBvcnQgeyBtZGlQcm9ncmVzc0Nsb3NlLCBtZGlUaW1lbGluZUNoZWNrIH0gZnJvbSAnQG1kaS9qcycKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU2FsZXNEckl0ZW1TZWxlY3Rpb25WdWUnLAogIHByb3BzOiB7CiAgICBhcmVhOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIGRlZmF1bHQ6IG51bGwsCiAgICB9LAogICAgaWQ6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6IG51bGwsCiAgICB9LAogICAgc2VsZWN0ZWRJdGVtczogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIGRlZmF1bHQ6ICgoKSA9PiBbXSksCiAgICB9LAogIH0sCiAgc2V0dXAocHJvcHMsIHsgZW1pdCB9KSB7CiAgICBjb25zdCB0cmlwVGlja2V0SWQgPSB0b1JlZihwcm9wcywgJ2lkJykKICAgIGNvbnN0IGFyZWFEYXRhID0gdG9SZWYocHJvcHMsICdhcmVhJykKICAgIGNvbnN0IHNlbGVjdGVkSXRlbXNQcm9wID0gdG9SZWYocHJvcHMsICdzZWxlY3RlZEl0ZW1zJykKICAgIGNvbnN0IHNlbGVjdGVkRHJJdGVtcyA9IHJlZihbXSkKICAgIGNvbnN0IHNhbGVzRHJJdGVtcyA9IGNvbXB1dGVkKCgpID0+IHN0b3JlLnN0YXRlLlNhbGVzRHJTdG9yZS5pdGVtcykKICAgIGNvbnN0IGhlYWRlcnMgPSBbCiAgICAgIHsKICAgICAgICB0ZXh0OiAnRGF0ZScsCiAgICAgICAgYWxpZ246ICdzdGFydCcsCiAgICAgICAgc29ydGFibGU6IGZhbHNlLAogICAgICAgIHZhbHVlOiAnc2FsZXNfZHJfaXRlbS5zYWxlc19kci5kYXRlX3Bvc3RlZCcsCiAgICAgIH0sCiAgICAgIHsgdGV4dDogJ0RSIE51bWJlcicsIHZhbHVlOiAnc2FsZXNfZHJfaXRlbS5zYWxlc19kci5zYWxlc19kcl9udW1iZXInIH0sCiAgICAgIHsgdGV4dDogJ0N1c3RvbWVyJywgdmFsdWU6ICdzYWxlc19kcl9pdGVtLnNhbGVzX2RyLmN1c3RvbWVyLm5hbWUnIH0sCiAgICAgIHsgdGV4dDogJ0FyZWEnLCB2YWx1ZTogJ3NhbGVzX2RyX2l0ZW0uc2FsZXNfZHIuYXJlYScgfSwKICAgICAgeyB0ZXh0OiAnSXRlbSBOYW1lJywgdmFsdWU6ICdwcm9kdWN0Lm5hbWUnIH0sCiAgICAgIHsgdGV4dDogJ1F1YW50aXR5JywgdmFsdWU6ICdxdWFudGl0eScgfSwKICAgICAgeyB0ZXh0OiAnVW5pdCcsIHZhbHVlOiAndW5pdCcgfSwKICAgIF0KCiAgICBjb25zdCBkYXRhID0gcmVmKHsKICAgICAgYXJlYTogYXJlYURhdGEudmFsdWUsCiAgICAgIGlkOiB0cmlwVGlja2V0SWQudmFsdWUsCiAgICB9KQoKICAgIGNvbnN0IGluaXRpYWxpemUgPSAoKSA9PiB7CiAgICAgIHN0b3JlLmRpc3BhdGNoKCdTYWxlc0RyU3RvcmUvZ2V0VW5saW5rSXRlbXMnLCBkYXRhLnZhbHVlKQogICAgfQoKICAgIG9uTW91bnRlZChhc3luYyAoKSA9PiB7CiAgICAgIGlmIChzZWxlY3RlZEl0ZW1zUHJvcC52YWx1ZS5sZW5ndGggPiAwKSB7CiAgICAgICAgc2VsZWN0ZWREckl0ZW1zLnZhbHVlID0gIHNlbGVjdGVkSXRlbXNQcm9wLnZhbHVlCiAgICAgIH0KCiAgICAgIGluaXRpYWxpemUoZGF0YS52YWx1ZSkKICAgIH0pCgogICAgd2F0Y2goYXJlYURhdGEsICgpID0+IHsKICAgICAgc3RvcmUuZGlzcGF0Y2goJ1NhbGVzRHJTdG9yZS9nZXRVbmxpbmtJdGVtcycsIGRhdGEudmFsdWUpCiAgICB9KQoKICAgIGNvbnN0IGNhbmNlbCA9ICgpID0+IHsKICAgICAgZW1pdCgnY2FuY2VsJykKICAgIH0KCiAgICBjb25zdCBhZGRPclVwZGF0ZUl0ZW1zID0gKCkgPT4gewogICAgICBlbWl0KCdhZGRPclVwZGF0ZUl0ZW1zJywgc2VsZWN0ZWREckl0ZW1zLnZhbHVlKQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGFkZE9yVXBkYXRlSXRlbXMsCiAgICAgIGNhbmNlbCwKICAgICAgaWNvbnM6IHsKICAgICAgICBtZGlQcm9ncmVzc0Nsb3NlLAogICAgICAgIG1kaVRpbWVsaW5lQ2hlY2ssCiAgICAgIH0sCiAgICAgIHNlbGVjdGVkRHJJdGVtcywKICAgICAgc2FsZXNEckl0ZW1zLAogICAgICBoZWFkZXJzLAogICAgfQogIH0sCn0K"},{"version":3,"sources":["SalesDrItemSelection.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SalesDrItemSelection.vue","sourceRoot":"src/views/pages/logistics/trip-tickets","sourcesContent":["<template>\n  <v-form>\n    <v-row>\n      <v-col cols=\"12\">\n        <v-data-table\n          v-model=\"selectedDrItems\"\n          show-select\n          :items=\"salesDrItems\"\n          :headers=\"headers\"\n        >\n        </v-data-table>\n      </v-col>\n      <v-col\n        cols=\"auto\"\n        class=\"d-flex\"\n      >\n        <v-btn\n          outlined\n          class=\"me-3 mt-4\"\n          type=\"reset\"\n          color=\"info\"\n          @click.prevent=\"cancel\"\n        >\n          <v-icon>\n            {{ icons.mdiProgressClose }}\n          </v-icon>\n          Close\n        </v-btn>\n        <v-btn\n          outlined\n          class=\"me-3 mt-4\"\n          type=\"reset\"\n          color=\"success\"\n          @click.prevent=\"addOrUpdateItems\"\n        >\n          <v-icon>\n            {{ icons.mdiTimelineCheck }}\n          </v-icon>\n          Submit\n        </v-btn>\n      </v-col>\n    </v-row>\n  </v-form>\n</template>\n\n<script>\nimport store from '@/store'\nimport {\n  watch,\n  onMounted,\n  computed,\n  toRef,\n  ref,\n} from '@vue/composition-api/dist/vue-composition-api'\nimport { mdiProgressClose, mdiTimelineCheck } from '@mdi/js'\n\nexport default {\n  name: 'SalesDrItemSelectionVue',\n  props: {\n    area: {\n      type: String,\n      required: true,\n      default: null,\n    },\n    id: {\n      type: Number,\n      required: false,\n      default: null,\n    },\n    selectedItems: {\n      type: Array,\n      required: true,\n      default: (() => []),\n    },\n  },\n  setup(props, { emit }) {\n    const tripTicketId = toRef(props, 'id')\n    const areaData = toRef(props, 'area')\n    const selectedItemsProp = toRef(props, 'selectedItems')\n    const selectedDrItems = ref([])\n    const salesDrItems = computed(() => store.state.SalesDrStore.items)\n    const headers = [\n      {\n        text: 'Date',\n        align: 'start',\n        sortable: false,\n        value: 'sales_dr_item.sales_dr.date_posted',\n      },\n      { text: 'DR Number', value: 'sales_dr_item.sales_dr.sales_dr_number' },\n      { text: 'Customer', value: 'sales_dr_item.sales_dr.customer.name' },\n      { text: 'Area', value: 'sales_dr_item.sales_dr.area' },\n      { text: 'Item Name', value: 'product.name' },\n      { text: 'Quantity', value: 'quantity' },\n      { text: 'Unit', value: 'unit' },\n    ]\n\n    const data = ref({\n      area: areaData.value,\n      id: tripTicketId.value,\n    })\n\n    const initialize = () => {\n      store.dispatch('SalesDrStore/getUnlinkItems', data.value)\n    }\n\n    onMounted(async () => {\n      if (selectedItemsProp.value.length > 0) {\n        selectedDrItems.value =  selectedItemsProp.value\n      }\n\n      initialize(data.value)\n    })\n\n    watch(areaData, () => {\n      store.dispatch('SalesDrStore/getUnlinkItems', data.value)\n    })\n\n    const cancel = () => {\n      emit('cancel')\n    }\n\n    const addOrUpdateItems = () => {\n      emit('addOrUpdateItems', selectedDrItems.value)\n    }\n\n    return {\n      addOrUpdateItems,\n      cancel,\n      icons: {\n        mdiProgressClose,\n        mdiTimelineCheck,\n      },\n      selectedDrItems,\n      salesDrItems,\n      headers,\n    }\n  },\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}