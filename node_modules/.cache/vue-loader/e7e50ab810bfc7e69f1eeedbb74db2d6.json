{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/sales/collections/SalesDrTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/sales/collections/SalesDrTable.vue","mtime":1665908978892},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1665368576151},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1665368593779}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1kaUFjY291bnRFZGl0LCBtZGlEZWxldGVDaXJjbGUgfSBmcm9tICdAbWRpL2pzJwppbXBvcnQgewogIHJlZiwgdG9SZWYsIHdhdGNoLAp9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpJwppbXBvcnQgeyBkYXRlRm9ybWF0MSB9IGZyb20gJ0AvdXRpbHMvdGltZScKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnU2FsZXNEclRhYmxlJywKICBjb21wb25lbnRzOiB7CiAgfSwKICBwcm9wczogewogICAgZGF0YTogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIGRlZmF1bHQ6IG51bGwsCiAgICB9LAogICAgc3RhdHVzOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiBudWxsLAogICAgfSwKICB9LAogIHNldHVwKHByb3BzLCB7IGVtaXQgfSkgewogICAgY29uc3QgY29sbGVjdGlvblN0YXR1cyA9IHRvUmVmKHByb3BzLCAnc3RhdHVzJykKICAgIGNvbnN0IHNob3dNb2RhbCA9IHJlZihmYWxzZSkKICAgIGNvbnN0IGl0ZW1zID0gdG9SZWYocHJvcHMsICdkYXRhJykKICAgIGNvbnN0IGhlYWRlcnMgPSByZWYoWwogICAgICB7CiAgICAgICAgdGV4dDogJ0RhdGUnLAogICAgICAgIGFsaWduOiAnc3RhcnQnLAogICAgICAgIHNvcnRhYmxlOiBmYWxzZSwKICAgICAgICB2YWx1ZTogJ2NyZWF0ZWRfYXQnLAogICAgICB9LAogICAgICB7IHRleHQ6ICdEUiBObycsIHZhbHVlOiAnc2FsZXNfZHJfbnVtYmVyJyB9LAogICAgICB7IHRleHQ6ICdSZW1haW5pbmcgQmFsYW5jZScsIHZhbHVlOiAncmVtYWluaW5nX2JhbGFuY2UnIH0sCiAgICAgIHsgdGV4dDogJ1RvIFBheScsIHZhbHVlOiAnYW1vdW50X3RvX3BheScgfSwKICAgICAgeyB0ZXh0OiAnQWN0aW9ucycsIHZhbHVlOiAnYWN0aW9ucycsIHNvcnRhYmxlOiBmYWxzZSB9LAogICAgXSkKCiAgICBjb25zdCBzYWxlc0RycyA9IHJlZihbXSkKICAgIGNvbnN0IHRvdGFsUGF5bWVudCA9IHJlZigwKQogICAgY29uc3QgZXJyb3JzID0gcmVmKHsKICAgICAgYW1vdW50X3RvX3BheTogW10sCiAgICB9KQoKICAgIGNvbnN0IHJlbW92ZURyID0gaXRlbSA9PiB7CiAgICAgIGVtaXQoJ3JlbW92ZURyJywgaXRlbSkKICAgIH0KCiAgICBjb25zdCB0b2dnbGVNb2RhbCA9ICgpID0+IHsKICAgICAgZW1pdCgnc2hvd01vZGFsJykKICAgIH0KCiAgICBjb25zdCBjYWxjdWxhdGVBbW91bnRUb1BheSA9ICgpID0+IHsKICAgICAgdG90YWxQYXltZW50LnZhbHVlID0gMAogICAgICBlcnJvcnMudmFsdWUuYW1vdW50X3RvX3BheSA9IFtdCgogICAgICBpZiAoaXRlbXMudmFsdWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIGl0ZW1zLnZhbHVlLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgaWYgKGl0ZW0uYW1vdW50X3RvX3BheSA9PT0gMCkgewogICAgICAgICAgZXJyb3JzLnZhbHVlLmFtb3VudF90b19wYXlbaW5kZXhdID0gJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQuJwogICAgICAgIH0KCiAgICAgICAgdG90YWxQYXltZW50LnZhbHVlICs9IHBhcnNlRmxvYXQoaXRlbS5hbW91bnRfdG9fcGF5KQogICAgICB9KQoKICAgICAgZW1pdCgndG90YWxQYXltZW50JywgdG90YWxQYXltZW50LnZhbHVlKQogICAgfQoKICAgIGNhbGN1bGF0ZUFtb3VudFRvUGF5KCkKCiAgICB3YXRjaChpdGVtcywgKCkgPT4gewogICAgICBjYWxjdWxhdGVBbW91bnRUb1BheSgpCiAgICB9KQoKICAgIHJldHVybiB7CiAgICAgIGNvbGxlY3Rpb25TdGF0dXMsCiAgICAgIGVycm9ycywKICAgICAgdG90YWxQYXltZW50LAogICAgICBjYWxjdWxhdGVBbW91bnRUb1BheSwKICAgICAgcmVtb3ZlRHIsCiAgICAgIGl0ZW1zLAogICAgICB0b2dnbGVNb2RhbCwKICAgICAgZGF0ZUZvcm1hdDEsCiAgICAgIG1kaUFjY291bnRFZGl0LAogICAgICBtZGlEZWxldGVDaXJjbGUsCiAgICAgIGhlYWRlcnMsCiAgICAgIHNhbGVzRHJzLAogICAgICBzaG93TW9kYWwsCiAgICAgIGljb25zOiB7CiAgICAgICAgbWRpQWNjb3VudEVkaXQsCiAgICAgICAgbWRpRGVsZXRlQ2lyY2xlLAogICAgICB9LAogICAgfQogIH0sCn0K"},{"version":3,"sources":["SalesDrTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SalesDrTable.vue","sourceRoot":"src/views/pages/sales/collections","sourcesContent":["<template>\n  <div class=\"pa-6\">\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"items\"\n      sort-by=\"name\"\n      class=\"elevation-1\"\n    >\n      <template #item.created_at=\"{ item }\">\n        {{ dateFormat1(item.created_at) }}\n      </template>\n      <template #item.remaining_balance=\"{ item }\">\n        <v-currency-field\n          v-model=\"item.remaining_balance\"\n          prefix=\"PHP\"\n          class=\"text-green\"\n          disabled\n        >\n        </v-currency-field>\n      </template>\n      <template #item.amount_to_pay=\"{ index, item }\">\n        <v-currency-field\n          v-model=\"item.amount_to_pay\"\n          clearable\n          :disabled=\"collectionStatus === 'Posted'\"\n          :max=\"item.remaining_balance\"\n          :error-messages=\"errors.amount_to_pay[index]\"\n          label=\"Enter Amount to Pay*\"\n          prefix=\"PHP\"\n          class=\"text-green\"\n          @change=\"calculateAmountToPay\"\n        >\n        </v-currency-field>\n      </template>\n      <template v-slot:item.actions=\"{ item }\">\n        <v-icon\n          small\n          @click=\"removeDr(item)\"\n        >\n          {{ icons.mdiDeleteCircle }}\n        </v-icon>\n      </template>\n      <template #footer>\n        <v-row class=\"mb-2 mt-2\">\n          <v-col\n            cols=\"6\"\n            class=\"mt-6\"\n          >\n            <p\n              class=\"font-italic\"\n              style=\"color: red\"\n            >\n              *Once a row is selected enter amount to proceed\n            </p>\n          </v-col>\n          <v-col\n            cols=\"2\"\n            class=\"mt-6\"\n            style=\"color: forestgreen;\"\n          >\n            Total Payment:\n          </v-col>\n          <v-col\n            cols=\"3\"\n            class=\"ml-n8\"\n          >\n            <v-currency-field\n              v-model=\"totalPayment\"\n              class=\"text-green\"\n              disabled\n            >\n            </v-currency-field>\n          </v-col>\n          <v-col\n            cols=\"4\"\n            class=\"\"\n          >\n            <v-btn\n              color=\"info\"\n              class=\"\"\n              @click=\"toggleModal\"\n            >\n              <v-icon>\n                {{ icons.mdiContentSave }}\n              </v-icon>\n              GET SALES DR\n            </v-btn>\n          </v-col>\n        </v-row>\n      </template>\n    </v-data-table>\n  </div>\n</template>\n\n<script>\nimport { mdiAccountEdit, mdiDeleteCircle } from '@mdi/js'\nimport {\n  ref, toRef, watch,\n} from '@vue/composition-api'\nimport { dateFormat1 } from '@/utils/time'\n\nexport default {\n  name: 'SalesDrTable',\n  components: {\n  },\n  props: {\n    data: {\n      type: Array,\n      required: true,\n      default: null,\n    },\n    status: {\n      type: String,\n      required: false,\n      default: null,\n    },\n  },\n  setup(props, { emit }) {\n    const collectionStatus = toRef(props, 'status')\n    const showModal = ref(false)\n    const items = toRef(props, 'data')\n    const headers = ref([\n      {\n        text: 'Date',\n        align: 'start',\n        sortable: false,\n        value: 'created_at',\n      },\n      { text: 'DR No', value: 'sales_dr_number' },\n      { text: 'Remaining Balance', value: 'remaining_balance' },\n      { text: 'To Pay', value: 'amount_to_pay' },\n      { text: 'Actions', value: 'actions', sortable: false },\n    ])\n\n    const salesDrs = ref([])\n    const totalPayment = ref(0)\n    const errors = ref({\n      amount_to_pay: [],\n    })\n\n    const removeDr = item => {\n      emit('removeDr', item)\n    }\n\n    const toggleModal = () => {\n      emit('showModal')\n    }\n\n    const calculateAmountToPay = () => {\n      totalPayment.value = 0\n      errors.value.amount_to_pay = []\n\n      if (items.value.length === 0) {\n        return\n      }\n\n      items.value.forEach((item, index) => {\n        if (item.amount_to_pay === 0) {\n          errors.value.amount_to_pay[index] = 'This field is required.'\n        }\n\n        totalPayment.value += parseFloat(item.amount_to_pay)\n      })\n\n      emit('totalPayment', totalPayment.value)\n    }\n\n    calculateAmountToPay()\n\n    watch(items, () => {\n      calculateAmountToPay()\n    })\n\n    return {\n      collectionStatus,\n      errors,\n      totalPayment,\n      calculateAmountToPay,\n      removeDr,\n      items,\n      toggleModal,\n      dateFormat1,\n      mdiAccountEdit,\n      mdiDeleteCircle,\n      headers,\n      salesDrs,\n      showModal,\n      icons: {\n        mdiAccountEdit,\n        mdiDeleteCircle,\n      },\n    }\n  },\n}\n</script>\n<style>\n.text-green input {\n  color: chartreuse !important;\n}\n\n</style>\n"]}]}