{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/warehouse/raw-materials-release/ReleaseForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/warehouse/raw-materials-release/ReleaseForm.vue","mtime":1659636478671},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1650363919730}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgcmVmLCBjb21wdXRlZCwgb25Nb3VudGVkLCB3YXRjaCwKfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaScKaW1wb3J0IHsKICBtZGlBY2Nlc3NQb2ludENoZWNrLAogIG1kaUFjY291bnRPdXRsaW5lLAogIG1kaVB1enpsZSwKICBtZGlDYWxlbmRhciwKICBtZGlDZWxscGhvbmUsCiAgbWRpRW1haWxPdXRsaW5lLCBtZGlFeWUsIG1kaUV5ZU9mZiwKICBtZGlHZW5kZXJOb25CaW5hcnksCiAgbWRpR3JvdXAsCiAgbWRpSG9tZUZsb29yMCwKICBtZGlIb21lUGx1cywKICBtZGlIdW1hbkVkaXQsCiAgbWRpSWRDYXJkLAogIG1kaUlkZW50aWZpZXIsCiAgbWRpTGlzdFN0YXR1cywKICBtZGlMb2NrT3V0bGluZSwgbWRpT3JpZ2luLAogIG1kaU91dGRvb3JMYW1wLAogIG1kaVBhY2thZ2UsIG1kaVBsdXNCb3hPdXRsaW5lLCBtZGlWaWV3TGlzdCwKfSBmcm9tICdAbWRpL2pzJwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZScKaW1wb3J0IHJvdXRlciBmcm9tICdAL3JvdXRlcicKaW1wb3J0IFJhd01hdGVyaWFsQWRkU2VsZWN0b3IgZnJvbSAnQC92aWV3cy9wYWdlcy93YXJlaG91c2UvcmF3LW1hdGVyaWFscy1yZWxlYXNlL2NvbXBvbmVudHMvUmF3TWF0ZXJpYWxBZGRTZWxlY3Rvci52dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1JlbGVhc2VGb3JtJywKICBjb21wb25lbnRzOiB7CiAgICBSYXdNYXRlcmlhbEFkZFNlbGVjdG9yLAogIH0sCiAgc2V0dXAoKSB7CiAgICBjb25zdCByZWxlYXNlRm9ybSA9IHJlZih7CiAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgdG90YWxfYm94ZXM6ICcnLAogICAgICB0b3RhbF9waWVjZXM6ICcnLAogICAgICBpdGVtOiAnJywKICAgIH0pCgogICAgY29uc3Qgc2VsZWN0ZWRQcm9kdWN0ID0gcmVmKCcnKQogICAgY29uc3Qgc2VsZWN0ZWRQcm9kdWN0SWRzID0gcmVmKFtdKQogICAgY29uc3QgYXR0YWNoZWRQcm9kdWN0cyA9IHJlZihbCiAgICAgIHsKICAgICAgICBwcm9kdWN0X2lkOiAnJywKICAgICAgICB0b3RhbF9waWVjZXM6ICcnLAogICAgICAgIHRvdGFsX2JveGVzOiAnJywKICAgICAgfSwKICAgIF0pCgogICAgY29uc3QgcHJvZHVjdERyb3Bkb3duID0gcmVmKFtdKQoKICAgIGNvbnN0IHByb2R1Y3RzID0gY29tcHV0ZWQoKCkgPT4gc3RvcmUuc3RhdGUuUmVsZWFzZU9yZGVyU3RvcmUucmF3TWF0ZXJpYWxzKQoKICAgIGNvbnN0IGVycm9ycyA9IGNvbXB1dGVkKCgpID0+IHN0b3JlLnN0YXRlLlVzZXJBY2Nlc3NNYW5hZ2VtZW50U3RvcmUuZXJyb3JzKQoKICAgIGNvbnN0IHZhbGlkYXRlU2VsZWN0ZWRQcm9kdWN0ID0gKCkgPT4gewogICAgICBwcm9kdWN0RHJvcGRvd24udmFsdWUgPSBwcm9kdWN0RHJvcGRvd24udmFsdWUubWFwKHByb2R1Y3QgPT4gewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnbgogICAgICAgIHByb2R1Y3QuZGlzYWJsZWQgPSBzZWxlY3RlZFByb2R1Y3RJZHMudmFsdWUuaW5jbHVkZXMocHJvZHVjdC5pZCkKCiAgICAgICAgcmV0dXJuIHByb2R1Y3QKICAgICAgfSkKICAgIH0KCiAgICBjb25zdCBhcnJheUNvbHVtbiA9IChhcnJheSwgY29sdW1uKSA9PiBhcnJheS5tYXAoaXRlbSA9PiBpdGVtW2NvbHVtbl0pCgogICAgY29uc3QgaGFuZGxlUmVtb3ZlUHJvZHVjdFJvdyA9IGluZGV4ID0+IHsKICAgICAgaWYgKGF0dGFjaGVkUHJvZHVjdHMudmFsdWUubGVuZ3RoID09PSAxKSB7CiAgICAgICAgYXR0YWNoZWRQcm9kdWN0cy52YWx1ZSA9IFsKICAgICAgICAgIHsKICAgICAgICAgICAgcHJvZHVjdF9pZDogJycsCiAgICAgICAgICAgIHRvdGFsX3BpZWNlczogJycsCiAgICAgICAgICAgIHRvdGFsX2JveGVzOiAnJywKICAgICAgICAgIH0sCiAgICAgICAgXQoKICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgYXR0YWNoZWRQcm9kdWN0cy52YWx1ZS5zcGxpY2UoaW5kZXgsIDEpCgogICAgICBzZWxlY3RlZFByb2R1Y3RJZHMudmFsdWUgPSBhcnJheUNvbHVtbihhdHRhY2hlZFByb2R1Y3RzLnZhbHVlLCAncHJvZHVjdF9pZCcpCgogICAgICB2YWxpZGF0ZVNlbGVjdGVkUHJvZHVjdCgpCiAgICB9CgogICAgY29uc3QgaGFuZGxlQWRkUHJvZHVjdFJvdyA9ICgpID0+IHsKICAgICAgc2VsZWN0ZWRQcm9kdWN0SWRzLnZhbHVlID0gYXJyYXlDb2x1bW4oYXR0YWNoZWRQcm9kdWN0cy52YWx1ZSwgJ3Byb2R1Y3RfaWQnKQoKICAgICAgaWYgKHNlbGVjdGVkUHJvZHVjdElkcy52YWx1ZVswXSA9PT0gJycpIHsKICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgYXR0YWNoZWRQcm9kdWN0cy52YWx1ZS5wdXNoKHsKICAgICAgICBwcm9kdWN0X2lkOiAnJywKICAgICAgICB0b3RhbF9waWVjZXM6ICcnLAogICAgICAgIHRvdGFsX2JveGVzOiAnJywKICAgICAgfSkKCiAgICAgIHZhbGlkYXRlU2VsZWN0ZWRQcm9kdWN0KCkKICAgIH0KCiAgICB3YXRjaCgKICAgICAgcHJvZHVjdHMsCiAgICAgICgpID0+IHsKICAgICAgICBwcm9kdWN0RHJvcGRvd24udmFsdWUgPSBwcm9kdWN0cy52YWx1ZQogICAgICB9LAogICAgICB7IGltbWVkaWF0ZTogdHJ1ZSB9LAogICAgKQoKICAgIG9uTW91bnRlZCgoKSA9PiB7CiAgICAgIHN0b3JlLmRpc3BhdGNoKCdSZWxlYXNlT3JkZXJTdG9yZS9nZXRSYXdNYXRlcmlhbHMnKQogICAgfSkKCiAgICBjb25zdCBzdWJtaXQgPSAoKSA9PiB7CiAgICAgIGNvbnN0IHJhd01hdGVyaWFscyA9IFtdCgogICAgICBhdHRhY2hlZFByb2R1Y3RzLnZhbHVlLmZvckVhY2gocHJvZHVjdCA9PiB7CiAgICAgICAgaWYgKHByb2R1Y3QucHJvZHVjdF9pZCAhPT0gJycpIHsKICAgICAgICAgIHJhd01hdGVyaWFscy5wdXNoKHByb2R1Y3QpCiAgICAgICAgfQogICAgICB9KQoKICAgICAgY29uc3QgZm9ybURhdGEgPSB7CiAgICAgICAgZGVzY3JpcHRpb246IHJlbGVhc2VGb3JtLnZhbHVlLmRlc2NyaXB0aW9uLAogICAgICAgIHJhd19tYXRlcmlhbHM6IHJhd01hdGVyaWFscywKICAgICAgfQoKICAgICAgc3RvcmUuZGlzcGF0Y2goJ1JlbGVhc2VPcmRlclN0b3JlL2NyZWF0ZVJlbGVhc2VPcmRlcicsIGZvcm1EYXRhKQogICAgICAgIC50aGVuKAogICAgICAgICAgcmVzcG9uc2UgPT4gewogICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICByb3V0ZXIucHVzaCgnL3Jhdy1tYXRlcmlhbHMtcmVsZWFzZScpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgKQogICAgfQoKICAgIGNvbnN0IGNhbmNlbCA9ICgpID0+IHsKICAgICAgcm91dGVyLnB1c2goJy9yYXctbWF0ZXJpYWxzLXJlbGVhc2UnKQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGhhbmRsZVJlbW92ZVByb2R1Y3RSb3csCiAgICAgIGF0dGFjaGVkUHJvZHVjdHMsCiAgICAgIGhhbmRsZUFkZFByb2R1Y3RSb3csCiAgICAgIHNlbGVjdGVkUHJvZHVjdCwKICAgICAgcHJvZHVjdERyb3Bkb3duLAogICAgICBjYW5jZWwsCiAgICAgIHN1Ym1pdCwKICAgICAgZXJyb3JzLAogICAgICByZWxlYXNlRm9ybSwKICAgICAgcHJvZHVjdHMsCiAgICAgIGljb25zOiB7CiAgICAgICAgbWRpUHV6emxlLAogICAgICAgIG1kaVZpZXdMaXN0LAogICAgICAgIG1kaVBhY2thZ2UsCiAgICAgICAgbWRpT3V0ZG9vckxhbXAsCiAgICAgICAgbWRpR2VuZGVyTm9uQmluYXJ5LAogICAgICAgIG1kaUdyb3VwLAogICAgICAgIG1kaUNhbGVuZGFyLAogICAgICAgIG1kaUFjY291bnRPdXRsaW5lLAogICAgICAgIG1kaVBsdXNCb3hPdXRsaW5lLAogICAgICAgIG1kaUVtYWlsT3V0bGluZSwKICAgICAgICBtZGlDZWxscGhvbmUsCiAgICAgICAgbWRpQWNjZXNzUG9pbnRDaGVjaywKICAgICAgICBtZGlMb2NrT3V0bGluZSwKICAgICAgICBtZGlIb21lRmxvb3IwLAogICAgICAgIG1kaUlkZW50aWZpZXIsCiAgICAgICAgbWRpSWRDYXJkLAogICAgICAgIG1kaUhvbWVQbHVzLAogICAgICAgIG1kaUxpc3RTdGF0dXMsCiAgICAgICAgbWRpSHVtYW5FZGl0LAogICAgICAgIG1kaUV5ZSwKICAgICAgICBtZGlFeWVPZmYsCiAgICAgICAgbWRpT3JpZ2luLAogICAgICB9LAogICAgfQogIH0sCn0K"},{"version":3,"sources":["ReleaseForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReleaseForm.vue","sourceRoot":"src/views/pages/warehouse/raw-materials-release","sourcesContent":["<template>\n  <v-card\n    id=\"raw-mats-release-form-card\"\n  >\n    <v-card-title>Raw Materials Release Form</v-card-title>\n    <v-form class=\"pa-3\">\n      <v-row>\n        <v-col\n          cols=\"12\"\n        >\n          <div\n            v-for=\"(item, index) in attachedProducts\"\n            :key=\"index\"\n          >\n            <raw-material-add-selector\n              :product-data=\"item\"\n              :product-dropdown=\"productDropdown\"\n              :item-number=\"index\"\n              @removeProductRow=\"handleRemoveProductRow\"\n              @addProductRow=\"handleAddProductRow\"\n            />\n          </div>\n        </v-col>\n\n        <v-col\n          cols=\"12\"\n          md=\"9\"\n        >\n          <v-textarea\n            id=\"description\"\n            v-model=\"releaseForm.description\"\n            outlined\n            rows=\"4\"\n            label=\"Description\"\n            :readonly=\"false\"\n            hide-details=\"auto\"\n            :prepend-inner-icon=\"icons.mdiViewList\"\n            :error-messages=\"errors.description\"\n            :persistent-placeholder=\"false\"\n          ></v-textarea>\n        </v-col>\n        <v-col cols=\"12\">\n          <v-btn\n            color=\"primary\"\n            class=\"me-3 mt-4\"\n            @click=\"submit\"\n          >\n            Submit\n          </v-btn>\n          <v-btn\n            color=\"error\"\n            outlined\n            class=\"me-3 mt-3\"\n            type=\"reset\"\n            @click.prevent=\"cancel\"\n          >\n            Cancel\n          </v-btn>\n        </v-col>\n      </v-row>\n    </v-form>\n  </v-card>\n</template>\n\n<script>\nimport {\n  ref, computed, onMounted, watch,\n} from '@vue/composition-api'\nimport {\n  mdiAccessPointCheck,\n  mdiAccountOutline,\n  mdiPuzzle,\n  mdiCalendar,\n  mdiCellphone,\n  mdiEmailOutline, mdiEye, mdiEyeOff,\n  mdiGenderNonBinary,\n  mdiGroup,\n  mdiHomeFloor0,\n  mdiHomePlus,\n  mdiHumanEdit,\n  mdiIdCard,\n  mdiIdentifier,\n  mdiListStatus,\n  mdiLockOutline, mdiOrigin,\n  mdiOutdoorLamp,\n  mdiPackage, mdiPlusBoxOutline, mdiViewList,\n} from '@mdi/js'\nimport store from '@/store'\nimport router from '@/router'\nimport RawMaterialAddSelector from '@/views/pages/warehouse/raw-materials-release/components/RawMaterialAddSelector.vue'\n\nexport default {\n  name: 'ReleaseForm',\n  components: {\n    RawMaterialAddSelector,\n  },\n  setup() {\n    const releaseForm = ref({\n      description: '',\n      total_boxes: '',\n      total_pieces: '',\n      item: '',\n    })\n\n    const selectedProduct = ref('')\n    const selectedProductIds = ref([])\n    const attachedProducts = ref([\n      {\n        product_id: '',\n        total_pieces: '',\n        total_boxes: '',\n      },\n    ])\n\n    const productDropdown = ref([])\n\n    const products = computed(() => store.state.ReleaseOrderStore.rawMaterials)\n\n    const errors = computed(() => store.state.UserAccessManagementStore.errors)\n\n    const validateSelectedProduct = () => {\n      productDropdown.value = productDropdown.value.map(product => {\n        // eslint-disable-next-line no-param-reassign\n        product.disabled = selectedProductIds.value.includes(product.id)\n\n        return product\n      })\n    }\n\n    const arrayColumn = (array, column) => array.map(item => item[column])\n\n    const handleRemoveProductRow = index => {\n      if (attachedProducts.value.length === 1) {\n        attachedProducts.value = [\n          {\n            product_id: '',\n            total_pieces: '',\n            total_boxes: '',\n          },\n        ]\n\n        return\n      }\n\n      attachedProducts.value.splice(index, 1)\n\n      selectedProductIds.value = arrayColumn(attachedProducts.value, 'product_id')\n\n      validateSelectedProduct()\n    }\n\n    const handleAddProductRow = () => {\n      selectedProductIds.value = arrayColumn(attachedProducts.value, 'product_id')\n\n      if (selectedProductIds.value[0] === '') {\n        return\n      }\n\n      attachedProducts.value.push({\n        product_id: '',\n        total_pieces: '',\n        total_boxes: '',\n      })\n\n      validateSelectedProduct()\n    }\n\n    watch(\n      products,\n      () => {\n        productDropdown.value = products.value\n      },\n      { immediate: true },\n    )\n\n    onMounted(() => {\n      store.dispatch('ReleaseOrderStore/getRawMaterials')\n    })\n\n    const submit = () => {\n      const rawMaterials = []\n\n      attachedProducts.value.forEach(product => {\n        if (product.product_id !== '') {\n          rawMaterials.push(product)\n        }\n      })\n\n      const formData = {\n        description: releaseForm.value.description,\n        raw_materials: rawMaterials,\n      }\n\n      store.dispatch('ReleaseOrderStore/createReleaseOrder', formData)\n        .then(\n          response => {\n            if (response.status === undefined) {\n              router.push('/raw-materials-release')\n            }\n          },\n        )\n    }\n\n    const cancel = () => {\n      router.push('/raw-materials-release')\n    }\n\n    return {\n      handleRemoveProductRow,\n      attachedProducts,\n      handleAddProductRow,\n      selectedProduct,\n      productDropdown,\n      cancel,\n      submit,\n      errors,\n      releaseForm,\n      products,\n      icons: {\n        mdiPuzzle,\n        mdiViewList,\n        mdiPackage,\n        mdiOutdoorLamp,\n        mdiGenderNonBinary,\n        mdiGroup,\n        mdiCalendar,\n        mdiAccountOutline,\n        mdiPlusBoxOutline,\n        mdiEmailOutline,\n        mdiCellphone,\n        mdiAccessPointCheck,\n        mdiLockOutline,\n        mdiHomeFloor0,\n        mdiIdentifier,\n        mdiIdCard,\n        mdiHomePlus,\n        mdiListStatus,\n        mdiHumanEdit,\n        mdiEye,\n        mdiEyeOff,\n        mdiOrigin,\n      },\n    }\n  },\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}