{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js!/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/user-access-management/departments/DepartmentForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/user-access-management/departments/DepartmentForm.vue","mtime":1657617408205},{"path":"/Users/mark/projects/enco-fe/babel.config.js","mtime":1655991784146},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1650363919730}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21hcmsvcHJvamVjdHMvZW5jby1mZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYXJrL3Byb2plY3RzL2VuY28tZmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgd2F0Y2gsIG9uTW91bnRlZCwgcmVmLCB0b1JlZiwgY29tcHV0ZWQgfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaS9kaXN0L3Z1ZS1jb21wb3NpdGlvbi1hcGknOwppbXBvcnQgeyBtZGlBY2NvdW50T3V0bGluZSwgbWRpQ2VsbHBob25lLCBtZGlFbWFpbE91dGxpbmUsIG1kaUxvY2tPdXRsaW5lIH0gZnJvbSAnQG1kaS9qcyc7CmltcG9ydCBVc2VyQWNjZXNzTWFuYWdlbWVudFNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL1VzZXJBY2Nlc3NNYW5hZ2VtZW50U2VydmljZSc7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJzsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBkZXBhcnRtZW50OiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9CiAgfSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAocHJvcHMsIF9yZWYpIHsKICAgIHZhciBlbWl0ID0gX3JlZi5lbWl0OwogICAgdmFyIGVycm9ycyA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHN0b3JlLnN0YXRlLlVzZXJBY2Nlc3NNYW5hZ2VtZW50U3RvcmUuZXJyb3JzOwogICAgfSk7CiAgICB2YXIgc2VydmljZSA9IG5ldyBVc2VyQWNjZXNzTWFuYWdlbWVudFNlcnZpY2UoKTsKICAgIHZhciByb2xlT3B0aW9ucyA9IHJlZihbXSk7CiAgICB2YXIgZGVwYXJ0bWVudERhdGEgPSB0b1JlZihwcm9wcywgJ2RlcGFydG1lbnQnKTsKICAgIHZhciBhYmlsaXRpZXNPcHRpb25zID0gcmVmKFtdKTsKICAgIHZhciBhYmlsaXRpZXNTZWxlY3RlZCA9IHJlZihbXSk7CiAgICB3YXRjaChkZXBhcnRtZW50RGF0YSwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIHZhciBfdmFsdWUkcm9sZXM7CgogICAgICBhYmlsaXRpZXNTZWxlY3RlZC52YWx1ZSA9IHZhbHVlLmFiaWxpdGllcy5tYXAoZnVuY3Rpb24gKGFiaWxpdHkpIHsKICAgICAgICByZXR1cm4gYWJpbGl0eS5pZDsKICAgICAgfSk7CiAgICAgIGRlcGFydG1lbnREYXRhLnZhbHVlLnJvbGVfaWRzID0gKF92YWx1ZSRyb2xlcyA9IHZhbHVlLnJvbGVzKSA9PT0gbnVsbCB8fCBfdmFsdWUkcm9sZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF92YWx1ZSRyb2xlcy5tYXAoZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgICByZXR1cm4gcm9sZS5pZDsKICAgICAgfSk7CiAgICB9KTsKICAgIG9uTW91bnRlZCggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmdldEFiaWxpdGllcyh0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgdmFyIF9kZXBhcnRtZW50RGF0YSR2YWx1ZTsKCiAgICAgICAgICAgICAgICBhYmlsaXRpZXNPcHRpb25zLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgIGFiaWxpdGllc1NlbGVjdGVkLnZhbHVlID0gKF9kZXBhcnRtZW50RGF0YSR2YWx1ZSA9IGRlcGFydG1lbnREYXRhLnZhbHVlLmFiaWxpdGllcykgPT09IG51bGwgfHwgX2RlcGFydG1lbnREYXRhJHZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZGVwYXJ0bWVudERhdGEkdmFsdWUubWFwKGZ1bmN0aW9uIChhYmlsaXR5KSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBhYmlsaXR5LmlkOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuZ2V0Um9sZXModHJ1ZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIHZhciBfZGVwYXJ0bWVudERhdGEkdmFsdWUyOwoKICAgICAgICAgICAgICAgIHJvbGVPcHRpb25zLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgIGRlcGFydG1lbnREYXRhLnZhbHVlLnJvbGVfaWRzID0gKF9kZXBhcnRtZW50RGF0YSR2YWx1ZTIgPSBkZXBhcnRtZW50RGF0YS52YWx1ZS5yb2xlcykgPT09IG51bGwgfHwgX2RlcGFydG1lbnREYXRhJHZhbHVlMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RlcGFydG1lbnREYXRhJHZhbHVlMi5tYXAoZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJvbGUuaWQ7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkpOwoKICAgIHZhciBjYW5jZWwgPSBmdW5jdGlvbiBjYW5jZWwoKSB7CiAgICAgIGVtaXQoJ2NsaWNrZWQnLCBmYWxzZSk7CiAgICB9OwoKICAgIHZhciBzdWJtaXQgPSBmdW5jdGlvbiBzdWJtaXQoKSB7CiAgICAgIGlmIChkZXBhcnRtZW50RGF0YS52YWx1ZS5pZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdmFyIF9kZXBhcnRtZW50RGF0YSR2YWx1ZTM7CgogICAgICAgIHZhciBmb3JtRGF0YSA9IHsKICAgICAgICAgIGFiaWxpdHlfaWRzOiBhYmlsaXRpZXNTZWxlY3RlZC52YWx1ZSwKICAgICAgICAgIG5hbWU6IGRlcGFydG1lbnREYXRhLnZhbHVlLm5hbWUsCiAgICAgICAgICByb2xlX2lkczogKF9kZXBhcnRtZW50RGF0YSR2YWx1ZTMgPSBkZXBhcnRtZW50RGF0YS52YWx1ZS5yb2xlX2lkcykgIT09IG51bGwgJiYgX2RlcGFydG1lbnREYXRhJHZhbHVlMyAhPT0gdm9pZCAwID8gX2RlcGFydG1lbnREYXRhJHZhbHVlMyA6IFtdCiAgICAgICAgfTsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgnVXNlckFjY2Vzc01hbmFnZW1lbnRTdG9yZS9jcmVhdGVEZXBhcnRtZW50JywgZm9ybURhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgZW1pdCgnY2xpY2tlZCcsIHsKICAgICAgICAgICAgICBhbGVydFR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICBhbGVydE1lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgQWRkZWQgYSBkZXBhcnRtZW50LicKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ1VzZXJBY2Nlc3NNYW5hZ2VtZW50U3RvcmUvdXBkYXRlRGVwYXJ0bWVudCcsIHsKICAgICAgICAgIGlkOiBkZXBhcnRtZW50RGF0YS52YWx1ZS5pZCwKICAgICAgICAgIGFiaWxpdHlfaWRzOiBhYmlsaXRpZXNTZWxlY3RlZC52YWx1ZSwKICAgICAgICAgIHJvbGVfaWRzOiBkZXBhcnRtZW50RGF0YS52YWx1ZS5yb2xlX2lkcwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ1VzZXJBY2Nlc3NNYW5hZ2VtZW50U3RvcmUvZ2V0RGVwYXJ0bWVudHMnKTsKICAgICAgICAgIGVtaXQoJ2NsaWNrZWQnLCBmYWxzZSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgYWJpbGl0aWVzU2VsZWN0ZWQ6IGFiaWxpdGllc1NlbGVjdGVkLAogICAgICBhYmlsaXRpZXNPcHRpb25zOiBhYmlsaXRpZXNPcHRpb25zLAogICAgICBjYW5jZWw6IGNhbmNlbCwKICAgICAgZXJyb3JzOiBlcnJvcnMsCiAgICAgIGljb25zOiB7CiAgICAgICAgbWRpQWNjb3VudE91dGxpbmU6IG1kaUFjY291bnRPdXRsaW5lLAogICAgICAgIG1kaUVtYWlsT3V0bGluZTogbWRpRW1haWxPdXRsaW5lLAogICAgICAgIG1kaUNlbGxwaG9uZTogbWRpQ2VsbHBob25lLAogICAgICAgIG1kaUxvY2tPdXRsaW5lOiBtZGlMb2NrT3V0bGluZQogICAgICB9LAogICAgICBkZXBhcnRtZW50RGF0YTogZGVwYXJ0bWVudERhdGEsCiAgICAgIHJvbGVPcHRpb25zOiByb2xlT3B0aW9ucywKICAgICAgc3VibWl0OiBzdWJtaXQKICAgIH07CiAgfSwKICBjb21wdXRlZDoge30sCiAgbWV0aG9kczoge30KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA,SACAA,KADA,EAEAC,SAFA,EAGAC,GAHA,EAIAC,KAJA,EAIAC,QAJA,QAKA,+CALA;AAMA,SACAC,iBADA,EAEAC,YAFA,EAGAC,eAHA,EAIAC,cAJA,QAKA,SALA;AAMA;AACA;AAEA;EACAC;IACAC;MACAC,YADA;MAEAC,eAFA;MAGAC;IAHA;EADA,CADA;EAQAC,KARA,iBAQAL,KARA,QAQA;IAAA;IACA;MAAA;IAAA;IACA;IACA;IACA;IACA;IACA;IAEAT;MAAA;;MACAe;QAAA;MAAA;MACAC;QAAA;MAAA;IACA,CAHA;IAKAf;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAgB,2BACAC,IADA,CACA;gBAAA;;gBACAC;gBACAJ;kBAAA;gBAAA;cACA,CAJA,CADA;;YAAA;cAAA;cAAA,OAOAE,uBACAC,IADA,CACA;gBAAA;;gBACAE;gBACAJ;kBAAA;gBAAA;cACA,CAJA,CAPA;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;;IAcA;MACAK;IACA,CAFA;;IAIA;MACA;QAAA;;QACA;UACAC,oCADA;UAEAC,+BAFA;UAGAC;QAHA;QAKAC,4EACA;UACA;YACAJ;cACAK,oBADA;cAEAC;YAFA;UAIA;QACA,CARA;MAUA,CAhBA,MAgBA;QACAF;UACAG,2BADA;UAEAN,oCAFA;UAGAE;QAHA,GAIAN,IAJA,CAKA;UACAO;UACAJ;QACA,CARA;MAUA;IACA,CA7BA;;IA+BA;MACAN,oCADA;MAEAI,kCAFA;MAGAU,cAHA;MAIAC,cAJA;MAKAC;QACA1B,oCADA;QAEAE,gCAFA;QAGAD,0BAHA;QAIAE;MAJA,CALA;MAWAQ,8BAXA;MAYAI,wBAZA;MAaAY;IAbA;EAeA,CArFA;EAsFA5B,YAtFA;EAwFA6B;AAxFA","names":["watch","onMounted","ref","toRef","computed","mdiAccountOutline","mdiCellphone","mdiEmailOutline","mdiLockOutline","props","department","type","required","default","setup","abilitiesSelected","departmentData","service","then","abilitiesOptions","roleOptions","emit","ability_ids","name","role_ids","store","alertType","alertMessage","id","cancel","errors","icons","submit","methods"],"sourceRoot":"src/views/pages/user-access-management/departments","sources":["DepartmentForm.vue"],"sourcesContent":["<template>\n  <v-form>\n    <v-row>\n      <v-col\n        cols=\"12\"\n        md=\"3\"\n      >\n        <label for=\"firstnameHorizontalIcons\">Department Name</label>\n      </v-col>\n\n      <v-col\n        cols=\"12\"\n        md=\"9\"\n      >\n        <v-text-field\n          id=\"firstnameHorizontalIcons\"\n          v-model=\"departmentData.name\"\n          hide-details=\"auto\"\n          :prepend-inner-icon=\"icons.mdiAccountOutline\"\n          outlined\n          dense\n          :error-messages=\"errors.name\"\n          placeholder=\"Department Name\"\n        ></v-text-field>\n      </v-col>\n      <v-col\n        cols=\"12\"\n        md=\"3\"\n      >\n        <label for=\"firstnameHorizontalIcons\">Roles</label>\n      </v-col>\n      <v-col\n        cols=\"12\"\n        md=\"9\"\n      >\n        <v-select\n          v-model=\"departmentData.role_ids\"\n          dense\n          outlined\n          multiple\n          :prepend-inner-icon=\"icons.mdiHumanEdit\"\n          item-text=\"title\"\n          item-value=\"id\"\n          label=\"Role\"\n          :items=\"roleOptions\"\n          hide-details=\"auto\"\n        ></v-select>\n      </v-col>\n      <v-col\n        cols=\"12\"\n        md=\"3\"\n      >\n        <label for=\"firstnameHorizontalIcons\">Abilities</label>\n      </v-col>\n\n      <v-col\n        cols=\"12\"\n        md=\"9\"\n      >\n        <v-treeview\n          v-model=\"abilitiesSelected\"\n          selectable\n          selected-color=\"primary\"\n          item-disabled=\"locked\"\n          item-key=\"id\"\n          item-text=\"name\"\n          item-children=\"abilities\"\n          hide-details=\"auto\"\n          :items=\"abilitiesOptions\"\n        ></v-treeview>\n      </v-col>\n      <v-col\n        offset-md=\"3\"\n        cols=\"12\"\n      >\n        <v-btn\n          color=\"primary\"\n          @click=\"submit\"\n        >\n          Submit\n        </v-btn>\n        <v-btn\n          type=\"reset\"\n          outlined\n          class=\"mx-2\"\n          @click=\"cancel\"\n        >\n          Cancel\n        </v-btn>\n      </v-col>\n    </v-row>\n  </v-form>\n</template>\n\n<script>\nimport {\n  watch,\n  onMounted,\n  ref,\n  toRef, computed,\n} from '@vue/composition-api/dist/vue-composition-api'\nimport {\n  mdiAccountOutline,\n  mdiCellphone,\n  mdiEmailOutline,\n  mdiLockOutline,\n} from '@mdi/js'\nimport UserAccessManagementService from '@/service/UserAccessManagementService'\nimport store from '@/store'\n\nexport default {\n  props: {\n    department: {\n      type: Object,\n      required: false,\n      default: null,\n    },\n  },\n  setup(props, { emit }) {\n    const errors = computed(() => store.state.UserAccessManagementStore.errors)\n    const service = new UserAccessManagementService()\n    const roleOptions = ref([])\n    const departmentData = toRef(props, 'department')\n    const abilitiesOptions = ref([])\n    const abilitiesSelected = ref([])\n\n    watch(departmentData, value => {\n      abilitiesSelected.value = value.abilities.map(ability => ability.id)\n      departmentData.value.role_ids = value.roles?.map(role => role.id)\n    })\n\n    onMounted(async () => {\n      await service.getAbilities(true)\n        .then(response => {\n          abilitiesOptions.value = response.data\n          abilitiesSelected.value = departmentData.value.abilities?.map(ability => ability.id)\n        })\n\n      await service.getRoles(true)\n        .then(response => {\n          roleOptions.value = response.data\n          departmentData.value.role_ids = departmentData.value.roles?.map(role => role.id)\n        })\n    })\n\n    const cancel = () => {\n      emit('clicked', false)\n    }\n\n    const submit = () => {\n      if (departmentData.value.id === undefined) {\n        const formData = {\n          ability_ids: abilitiesSelected.value,\n          name: departmentData.value.name,\n          role_ids: departmentData.value.role_ids ?? [],\n        }\n        store.dispatch('UserAccessManagementStore/createDepartment', formData).then(\n          response => {\n            if (response.status === undefined) {\n              emit('clicked', {\n                alertType: 'success',\n                alertMessage: 'Successfully Added a department.',\n              })\n            }\n          },\n        )\n      } else {\n        store.dispatch('UserAccessManagementStore/updateDepartment', {\n          id: departmentData.value.id,\n          ability_ids: abilitiesSelected.value,\n          role_ids: departmentData.value.role_ids,\n        }).then(\n          () => {\n            store.dispatch('UserAccessManagementStore/getDepartments')\n            emit('clicked', false)\n          },\n        )\n      }\n    }\n\n    return {\n      abilitiesSelected,\n      abilitiesOptions,\n      cancel,\n      errors,\n      icons: {\n        mdiAccountOutline,\n        mdiEmailOutline,\n        mdiCellphone,\n        mdiLockOutline,\n      },\n      departmentData,\n      roleOptions,\n      submit,\n    }\n  },\n  computed: {\n  },\n  methods: {\n  },\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}