{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js!/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/purchase-orders/purchase-order/PurchaseOrderInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/purchase-orders/purchase-order/PurchaseOrderInfo.vue","mtime":1662257651425},{"path":"/Users/mark/projects/enco-fe/babel.config.js","mtime":1655991784146},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1650363919730}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL21hcmsvcHJvamVjdHMvZW5jby1mZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgY29tcHV0ZWQsIHJlZiwgd2F0Y2ggfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaSc7CmltcG9ydCByb3V0ZXIgZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZSc7CmltcG9ydCB7IENSRUFURV9QVVJDSEFTRV9PUkRFUiwgVVBEQVRFX1BVUkNIQVNFX09SREVSLCBHRVRfUFJPRFVDVFMsIEdFVF9TVVBQTElFUlMgfSBmcm9tICdAL3N0b3JlL2FjdGlvbnMudHlwZSc7CmltcG9ydCBQdXJjaGFzZU9yZGVyQWRkU2VsZWN0b3IgZnJvbSAnQC92aWV3cy9wYWdlcy9wdXJjaGFzZS1vcmRlcnMvY29tcG9uZW50L1B1cmNoYXNlT3JkZXJBZGRTZWxlY3Rvcic7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBQdXJjaGFzZU9yZGVyQWRkU2VsZWN0b3I6IFB1cmNoYXNlT3JkZXJBZGRTZWxlY3RvcgogIH0sCiAgcHJvcHM6IHsKICAgIGluZm9ybWF0aW9uRGF0YTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBuYW1lOiAnJywKICAgICAgICAgIHNrdTogJycsCiAgICAgICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgICAgICBpbl9zdG9jazogJycsCiAgICAgICAgICB0b3RhbDogJycsCiAgICAgICAgICBwYWlkX2Ftb3VudDogJycsCiAgICAgICAgICBzdXBwbGllcjogbnVsbCwKICAgICAgICAgIHN1cHBsaWVyX2lkOiBudWxsCiAgICAgICAgfTsKICAgICAgfQogICAgfSwKICAgIG1vZGU6IHsKICAgICAgdHlwZTogU3RyaW5nCiAgICB9CiAgfSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAocHJvcHMpIHsKICAgIHZhciBidXR0b25MYWJlbCA9IHByb3BzLm1vZGUgPT09ICdjcmVhdGUnID8gJ1NhdmUnIDogJ1VwZGF0ZSc7CiAgICB2YXIgc2hvd0FsZXJ0ID0gcmVmKGZhbHNlKTsKICAgIHZhciBzZWxlY3RlZFN1cHBsaWVyID0gcmVmKCcnKTsKICAgIHZhciBoYXNTZWxlY3RlZFByb2R1Y3QgPSByZWYoZmFsc2UpOwogICAgdmFyIGF0dGFjaGVkUHJvZHVjdHMgPSByZWYoW10pOwogICAgdmFyIHNlbGVjdGVkUHJvZHVjdElkcyA9IHJlZihbXSk7CiAgICB2YXIgcHJvZHVjdFJvdyA9IHJlZigxKTsKICAgIHZhciBwcm9kdWN0RHJvcGRvd24gPSByZWYoW10pOwogICAgdmFyIGZvcm1TdWJtaXR0ZWQgPSByZWYoZmFsc2UpOwogICAgdmFyIGVycm9ycyA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHN0b3JlLmdldHRlcnMuZXJyb3JzOwogICAgfSk7CiAgICB2YXIgb3B0aW9uc0xvY2FsID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gcHJvcHMuaW5mb3JtYXRpb25EYXRhOwogICAgfSk7CiAgICB2YXIgcHJvZHVjdHMgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBzdG9yZS5nZXR0ZXJzLnByb2R1Y3RzOwogICAgfSk7CiAgICB2YXIgc3VwcGxpZXJzID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gc3RvcmUuZ2V0dGVycy5zdXBwbGllcnM7CiAgICB9KTsKICAgIHN0b3JlLmRpc3BhdGNoKEdFVF9TVVBQTElFUlMpOwoKICAgIHZhciBnb0JhY2sgPSBmdW5jdGlvbiBnb0JhY2soKSB7CiAgICAgIHJvdXRlci5wdXNoKCcvcHVyY2hhc2Utb3JkZXJzJyk7CiAgICB9OwoKICAgIHZhciBhdHRhY2hQcm9kdWN0cyA9IGZ1bmN0aW9uIGF0dGFjaFByb2R1Y3RzKGl0ZW0sIGluZGV4KSB7CiAgICAgIGF0dGFjaGVkUHJvZHVjdHMudmFsdWVbaW5kZXggLSAxXSA9IGl0ZW07CiAgICAgIHNlbGVjdGVkUHJvZHVjdElkcy52YWx1ZVtpbmRleCAtIDFdID0gaXRlbS5wcm9kdWN0X2lkOwoKICAgICAgaWYgKHNlbGVjdGVkUHJvZHVjdElkcy52YWx1ZS5sZW5ndGgpIHsKICAgICAgICAvLyBhZGQgZGlzYWJsZSBwcm9wZXJ0eSB0byBwcmV2aW91cyBzZWxlY3RlZCBpdGVtcwogICAgICAgIHByb2R1Y3REcm9wZG93bi52YWx1ZSA9IHByb2R1Y3REcm9wZG93bi52YWx1ZS5tYXAoZnVuY3Rpb24gKHByb2R1Y3QpIHsKICAgICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHByb2R1Y3QpLCB7fSwgewogICAgICAgICAgICBkaXNhYmxlZDogc2VsZWN0ZWRQcm9kdWN0SWRzLnZhbHVlLmluY2x1ZGVzKHByb2R1Y3QuaWQpID8gdHJ1ZSA6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaGFzU2VsZWN0ZWRQcm9kdWN0LnZhbHVlID0gdHJ1ZTsKICAgIH07CgogICAgdmFyIHJlc29sdmVGb3JtU3VjY2VzcyA9IGZ1bmN0aW9uIHJlc29sdmVGb3JtU3VjY2VzcygpIHsKICAgICAgc2hvd0FsZXJ0LnZhbHVlID0gdHJ1ZTsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgZ29CYWNrKCk7CiAgICAgIH0sIDEwMDApOwogICAgfTsKCiAgICB2YXIgaGFuZGxlQWRkUHJvZHVjdFJvdyA9IGZ1bmN0aW9uIGhhbmRsZUFkZFByb2R1Y3RSb3coKSB7CiAgICAgIGlmIChwcm9kdWN0Um93LnZhbHVlIDwgNSkgcHJvZHVjdFJvdy52YWx1ZSArPSAxOwogICAgfTsKCiAgICB2YXIgc2F2ZSA9IGZ1bmN0aW9uIHNhdmUoKSB7CiAgICAgIHZhciBjdXJyZW50Rm9ybSA9IG9wdGlvbnNMb2NhbC52YWx1ZTsKICAgICAgY3VycmVudEZvcm0uaXRlbXMgPSBhdHRhY2hlZFByb2R1Y3RzLnZhbHVlOwoKICAgICAgaWYgKGN1cnJlbnRGb3JtLml0ZW1zID09PSBudWxsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZm9ybSA9IGN1cnJlbnRGb3JtOwogICAgICBmb3JtU3VibWl0dGVkLnZhbHVlID0gdHJ1ZTsKICAgICAgY29uc29sZS5sb2coZm9ybSk7CgogICAgICBpZiAocHJvcHMubW9kZSA9PT0gJ3VwZGF0ZScpIHsKICAgICAgICBzdG9yZS5kaXNwYXRjaChVUERBVEVfUFVSQ0hBU0VfT1JERVIsIGZvcm0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgIGlmIChkYXRhICE9IG51bGwpIHsKICAgICAgICAgICAgcmVzb2x2ZUZvcm1TdWNjZXNzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmIChwcm9wcy5tb2RlID09PSAnY3JlYXRlJykgewogICAgICAgIHN0b3JlLmRpc3BhdGNoKENSRUFURV9QVVJDSEFTRV9PUkRFUiwgZm9ybSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCkgewogICAgICAgICAgICByZXNvbHZlRm9ybVN1Y2Nlc3MoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfTsKCiAgICB3YXRjaChwcm9kdWN0cywgZnVuY3Rpb24gKCkgewogICAgICBwcm9kdWN0RHJvcGRvd24udmFsdWUgPSBwcm9kdWN0cy52YWx1ZTsKICAgIH0sIHsKICAgICAgaW1tZWRpYXRlOiB0cnVlCiAgICB9KTsKICAgIHN0b3JlLmRpc3BhdGNoKEdFVF9QUk9EVUNUUyk7CiAgICByZXR1cm4gewogICAgICBzZWxlY3RlZFN1cHBsaWVyOiBzZWxlY3RlZFN1cHBsaWVyLAogICAgICBoYXNTZWxlY3RlZFByb2R1Y3Q6IGhhc1NlbGVjdGVkUHJvZHVjdCwKICAgICAgb3B0aW9uc0xvY2FsOiBvcHRpb25zTG9jYWwsCiAgICAgIHNob3dBbGVydDogc2hvd0FsZXJ0LAogICAgICBlcnJvcnM6IGVycm9ycywKICAgICAgYnV0dG9uTGFiZWw6IGJ1dHRvbkxhYmVsLAogICAgICBwcm9kdWN0Um93OiBwcm9kdWN0Um93LAogICAgICBwcm9kdWN0RHJvcGRvd246IHByb2R1Y3REcm9wZG93biwKICAgICAgZ29CYWNrOiBnb0JhY2ssCiAgICAgIHNhdmU6IHNhdmUsCiAgICAgIGF0dGFjaFByb2R1Y3RzOiBhdHRhY2hQcm9kdWN0cywKICAgICAgaGFuZGxlQWRkUHJvZHVjdFJvdzogaGFuZGxlQWRkUHJvZHVjdFJvdywKICAgICAgc3VwcGxpZXJzOiBzdXBwbGllcnMsCiAgICAgIGZvcm1TdWJtaXR0ZWQ6IGZvcm1TdWJtaXR0ZWQKICAgIH07CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuGA;AACA;AACA;AACA,SACAA,qBADA,EAEAC,qBAFA,EAGAC,YAHA,EAGAC,aAHA,QAIA,sBAJA;AAKA,qCACA,kEADA;AAGA;EACAC;IAAAC;EAAA,CADA;EAEAC;IACAC;MACAC,YADA;MAEAC;QAAA;UACAC,QADA;UAEAC,OAFA;UAGAC,eAHA;UAIAC,YAJA;UAKAC,SALA;UAMAC,eANA;UAOAC,cAPA;UAQAC;QARA;MAAA;IAFA,CADA;IAcAC;MACAV;IADA;EAdA,CAFA;EAoBAW,KApBA,iBAoBAb,KApBA,EAoBA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;MAAA;IAAA;IACA;MAAA;IAAA;IACA;MAAA;IAAA;IACA;MAAA;IAAA;IAEAc;;IAEA;MACAC;IACA,CAFA;;IAIA;MACAC;MACAC;;MAEA;QACA;QACAC;UACA,uCACAC,OADA;YAEAC;UAFA;QAIA,CALA;MAMA;;MAEAC;IACA,CAfA;;IAiBA;MACAC;MACAC;QACAC;MACA,CAFA,EAEA,IAFA;IAGA,CALA;;IAOA;MACA;IACA,CAFA;;IAIA;MACA;MACAC;;MAEA;QACA;MACA;;MACA;MACAC;MAEAC;;MAEA;QACAb;UACA;YACAc;UACA;QACA,CAJA;MAKA;;MAEA;QACAd;UACA;YACAc;UACA;QACA,CAJA;MAKA;IACA,CA3BA;;IA6BAC,MACAC,QADA,EAEA;MACAZ;IACA,CAJA,EAKA;MAAAa;IAAA,CALA;IAQAjB;IAEA;MACAkB,kCADA;MAEAX,sCAFA;MAGAY,0BAHA;MAIAX,oBAJA;MAKAY,cALA;MAMAC,wBANA;MAOAC,sBAPA;MAQAlB,gCARA;MASAM,cATA;MAUAa,UAVA;MAWAC,8BAXA;MAYAC,wCAZA;MAaAC,oBAbA;MAcAd;IAdA;EAgBA;AA5HA","names":["CREATE_PURCHASE_ORDER","UPDATE_PURCHASE_ORDER","GET_PRODUCTS","GET_SUPPLIERS","components","PurchaseOrderAddSelector","props","informationData","type","default","name","sku","description","in_stock","total","paid_amount","supplier","supplier_id","mode","setup","store","router","attachedProducts","selectedProductIds","productDropdown","product","disabled","hasSelectedProduct","showAlert","setTimeout","goBack","currentForm","formSubmitted","console","resolveFormSuccess","watch","products","immediate","selectedSupplier","optionsLocal","errors","buttonLabel","productRow","save","attachProducts","handleAddProductRow","suppliers"],"sourceRoot":"src/views/pages/purchase-orders/purchase-order","sources":["PurchaseOrderInfo.vue"],"sourcesContent":["<template>\n  <v-card\n    flat\n    class=\"pa-3 mt-2\"\n  >\n    <v-alert\n      v-show=\"showAlert\"\n      dense\n      text\n      type=\"success\"\n    >\n      Successfully <strong>{{ mode }}d</strong> a purchase order. You will be automatically\n      redirected in a bit.\n    </v-alert>\n    <v-form class=\"multi-col-validation\">\n      <v-card-text class=\"pt-5\">\n        <v-row>\n          <v-col>\n            <div\n              v-for=\"index in productRow\"\n              :key=\"index\"\n            >\n              <purchase-order-add-selector\n                @selectedProduct=\"attachProducts\"\n                @addProductRow=\"handleAddProductRow\"\n                :product-dropdown=\"productDropdown\"\n                :item-number=\"index\"\n                :form-submit=\"formSubmitted\"\n              />\n            </div>\n          </v-col>\n          <v-col\n            cols=\"12\"\n          >\n            <v-text-field\n              v-model=\"optionsLocal.description\"\n              dense\n              label=\"Description\"\n              :readonly=\"mode === 'show'\"\n              hide-details=\"auto\"\n              :error-messages=\"errors.description\"\n              :persistent-placeholder=\"mode === 'show'\"\n            ></v-text-field>\n          </v-col>\n        </v-row>\n      </v-card-text>\n\n      <v-card-text class=\"mt-10\">\n        <v-simple-table\n          fixed-header\n          height=\"300px\"\n        >\n          <v-subheader>\n            Subheader\n          </v-subheader>\n          <template v-slot:default>\n            <thead>\n            <tr>\n              <th class=\"text-left\">\n                Name\n              </th>\n              <th class=\"text-left\">\n                Quantity In Stock\n              </th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr\n              v-for=\"item in productDropdown\"\n              :key=\"item.name\"\n            >\n              <td>{{ item.name }}</td>\n              <td>{{ item.in_stock }}</td>\n            </tr>\n            </tbody>\n          </template>\n        </v-simple-table>\n      </v-card-text>\n\n      <v-card-text>\n        <v-btn\n          v-show=\"mode === 'create' || mode === 'update'\"\n          outlined\n          class=\"mt-3 mr-3\"\n          color=\"primary\"\n          @click=\"save\"\n        >\n          {{ buttonLabel }}\n        </v-btn>\n        <v-btn\n          outlined\n          class=\"mt-3\"\n          type=\"reset\"\n          @click.prevent=\"goBack\"\n        >\n          Back to List\n        </v-btn>\n      </v-card-text>\n    </v-form>\n  </v-card>\n</template>\n\n<script>\nimport {computed, ref, watch} from '@vue/composition-api'\nimport router from '@/router'\nimport store from '@/store'\nimport {\n  CREATE_PURCHASE_ORDER,\n  UPDATE_PURCHASE_ORDER,\n  GET_PRODUCTS, GET_SUPPLIERS\n} from '@/store/actions.type'\nimport PurchaseOrderAddSelector\n  from '@/views/pages/purchase-orders/component/PurchaseOrderAddSelector'\n\nexport default {\n  components: {PurchaseOrderAddSelector},\n  props: {\n    informationData: {\n      type: Object,\n      default: () => ({\n        name: '',\n        sku: '',\n        description: '',\n        in_stock: '',\n        total: '',\n        paid_amount: '',\n        supplier: null,\n        supplier_id: null,\n      }),\n    },\n    mode: {\n      type: String,\n    },\n  },\n  setup(props) {\n    const buttonLabel = props.mode === 'create' ? 'Save' : 'Update'\n    const showAlert = ref(false)\n    const selectedSupplier = ref('')\n    const hasSelectedProduct = ref(false)\n    const attachedProducts = ref([])\n    const selectedProductIds = ref([])\n    const productRow = ref(1)\n    const productDropdown = ref([])\n    const formSubmitted = ref(false)\n    const errors = computed(() => store.getters.errors)\n    const optionsLocal = computed(() => props.informationData)\n    const products = computed(() => store.getters.products)\n    const suppliers = computed(() => store.getters.suppliers)\n\n    store.dispatch(GET_SUPPLIERS)\n\n    const goBack = () => {\n      router.push('/purchase-orders')\n    }\n\n    const attachProducts = (item, index) => {\n      attachedProducts.value[index - 1] = item\n      selectedProductIds.value[index - 1] = item.product_id\n\n      if (selectedProductIds.value.length) {\n        // add disable property to previous selected items\n        productDropdown.value = productDropdown.value.map(product => {\n          return {\n            ...product,\n            disabled: selectedProductIds.value.includes(product.id) ? true : false,\n          }\n        })\n      }\n\n      hasSelectedProduct.value = true\n    }\n\n    const resolveFormSuccess = () => {\n      showAlert.value = true\n      setTimeout(() => {\n        goBack()\n      }, 1000)\n    }\n\n    const handleAddProductRow = () => {\n      if (productRow.value < 5) productRow.value += 1\n    }\n\n    const save = () => {\n      const currentForm = optionsLocal.value\n      currentForm.items = attachedProducts.value\n\n      if (currentForm.items === null) {\n        return\n      }\n      const form = currentForm\n      formSubmitted.value = true\n\n      console.log(form)\n\n      if (props.mode === 'update') {\n        store.dispatch(UPDATE_PURCHASE_ORDER, form).then(data => {\n          if (data != null) {\n            resolveFormSuccess()\n          }\n        })\n      }\n\n      if (props.mode === 'create') {\n        store.dispatch(CREATE_PURCHASE_ORDER, form).then(data => {\n          if (data != null) {\n            resolveFormSuccess()\n          }\n        })\n      }\n    }\n\n    watch(\n      products,\n      () => {\n        productDropdown.value = products.value\n      },\n      {immediate: true}\n    )\n\n    store.dispatch(GET_PRODUCTS)\n\n    return {\n      selectedSupplier,\n      hasSelectedProduct,\n      optionsLocal,\n      showAlert,\n      errors,\n      buttonLabel,\n      productRow,\n      productDropdown,\n      goBack,\n      save,\n      attachProducts,\n      handleAddProductRow,\n      suppliers,\n      formSubmitted\n    }\n  },\n}\n</script>\n"]}]}