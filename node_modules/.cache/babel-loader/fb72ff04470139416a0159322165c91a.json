{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js!/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/sales/collections/DrListSelection.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/sales/collections/DrListSelection.vue","mtime":1665647763710},{"path":"/Users/mark/projects/enco-fe/babel.config.js","mtime":1655991784146},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1665368576151},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1665368576185},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1665368593779}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21hcmsvcHJvamVjdHMvZW5jby1mZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYXJrL3Byb2plY3RzL2VuY28tZmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IGNvbXB1dGVkLCByZWYsIHRvUmVmLCB3YXRjaCwgb25Nb3VudGVkLCBvblVubW91bnRlZCB9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpJzsKaW1wb3J0IHN0b3JlIGZyb20gJ0Avc3RvcmUnOwppbXBvcnQgeyBkYXRlRm9ybWF0MSB9IGZyb20gJ0AvdXRpbHMvdGltZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRHJMaXN0U2VsZWN0aW9uJywKICBwcm9wczogewogICAgY3VzdG9tZXJJZDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9LAogICAgZXhpc3RpbmdTZWxlY3RlZERyOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0KICB9LAogIHNldHVwOiBmdW5jdGlvbiBzZXR1cChwcm9wcywgX3JlZikgewogICAgdmFyIGVtaXQgPSBfcmVmLmVtaXQ7CiAgICB2YXIgY3VzdG9tZXJJZERhdGEgPSB0b1JlZihwcm9wcywgJ2N1c3RvbWVySWQnKTsKICAgIHZhciBleGlzdGluZ1NlbGVjdGVkRHJzID0gdG9SZWYocHJvcHMsICdleGlzdGluZ1NlbGVjdGVkRHInKTsKICAgIHZhciBzZWxlY3RlZERycyA9IHJlZihbXSk7CiAgICB2YXIgbGlzdCA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHN0b3JlLnN0YXRlLlNhbGVzRHJTdG9yZS5pdGVtczsKICAgIH0pOwogICAgdmFyIGxvYWRpbmcgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBzdG9yZS5zdGF0ZS5TYWxlc0RyU3RvcmUubG9hZGluZzsKICAgIH0pOwogICAgdmFyIHNob3dTdWJtaXQgPSByZWYoZmFsc2UpOwogICAgdmFyIHNlYXJjaCA9IHJlZigpOwogICAgdmFyIGxpc3RSZWNvbXB1dGUgPSByZWYoW10pOwoKICAgIHZhciByZWluaXRpYWxpemVFeGlzdGluZ1NlbGVjdGVkRHJzID0gZnVuY3Rpb24gcmVpbml0aWFsaXplRXhpc3RpbmdTZWxlY3RlZERycygpIHsKICAgICAgaWYgKGV4aXN0aW5nU2VsZWN0ZWREcnMudmFsdWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgc2VsZWN0ZWREcnMudmFsdWUgPSBbXTsKICAgICAgICBzdG9yZS5kaXNwYXRjaCgnU2FsZXNEclN0b3JlL2RyTGlzdEJ5Q3VzdG9tZXInLCBjdXN0b21lcklkRGF0YS52YWx1ZSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBsaXN0UmVjb21wdXRlLnZhbHVlID0gW107CiAgICAgIHNlbGVjdGVkRHJzLnZhbHVlID0gW107CiAgICAgIGV4aXN0aW5nU2VsZWN0ZWREcnMudmFsdWUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGxpc3QudmFsdWUuZm9yRWFjaChmdW5jdGlvbiAobGlzdEl0ZW0pIHsKICAgICAgICAgIHZhciBfaXRlbSRzYWxlc19kciRpZCwgX2l0ZW0kc2FsZXNfZHI7CgogICAgICAgICAgdmFyIGlkID0gKF9pdGVtJHNhbGVzX2RyJGlkID0gKF9pdGVtJHNhbGVzX2RyID0gaXRlbS5zYWxlc19kcikgPT09IG51bGwgfHwgX2l0ZW0kc2FsZXNfZHIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pdGVtJHNhbGVzX2RyLmlkKSAhPT0gbnVsbCAmJiBfaXRlbSRzYWxlc19kciRpZCAhPT0gdm9pZCAwID8gX2l0ZW0kc2FsZXNfZHIkaWQgOiBpdGVtLmlkOwogICAgICAgICAgdmFyIGV4aXN0ID0gbGlzdEl0ZW0uaWQgPT09IGlkID8gbGlzdEl0ZW0gOiBmYWxzZTsKCiAgICAgICAgICBpZiAoZXhpc3QpIHsKICAgICAgICAgICAgbGlzdFJlY29tcHV0ZS52YWx1ZS5wdXNoKGV4aXN0KTsKICAgICAgICAgICAgc2VsZWN0ZWREcnMudmFsdWUucHVzaChleGlzdCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsaXN0UmVjb21wdXRlLnZhbHVlLnB1c2gobGlzdEl0ZW0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgc3RvcmUuZGlzcGF0Y2goJ1NhbGVzRHJTdG9yZS91cGRhdGVPcmRlckl0ZW1zJywgbGlzdFJlY29tcHV0ZS52YWx1ZSk7CiAgICB9OwoKICAgIG9uTW91bnRlZCggLyojX19QVVJFX18qL19hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiByZWluaXRpYWxpemVFeGlzdGluZ1NlbGVjdGVkRHJzKCk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKTsKICAgIG9uVW5tb3VudGVkKCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvclJ1bnRpbWUoKS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIHJlaW5pdGlhbGl6ZUV4aXN0aW5nU2VsZWN0ZWREcnMoKTsKCiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUyKTsKICAgIH0pKSk7CiAgICB3YXRjaChleGlzdGluZ1NlbGVjdGVkRHJzLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJlaW5pdGlhbGl6ZUV4aXN0aW5nU2VsZWN0ZWREcnMoKTsKICAgIH0pOwoKICAgIHZhciBzdWJtaXQgPSBmdW5jdGlvbiBzdWJtaXQoKSB7CiAgICAgIGVtaXQoJ3NlbGVjdGVkRHJzJywgc2VsZWN0ZWREcnMudmFsdWUpOwogICAgfTsKCiAgICB2YXIgY2FuY2VsID0gZnVuY3Rpb24gY2FuY2VsKCkgewogICAgICBlbWl0KCdjYW5jZWwnKTsKICAgIH07CgogICAgcmV0dXJuIHsKICAgICAgY2FuY2VsOiBjYW5jZWwsCiAgICAgIGRhdGVGb3JtYXQxOiBkYXRlRm9ybWF0MSwKICAgICAgc2VhcmNoOiBzZWFyY2gsCiAgICAgIHNob3dTdWJtaXQ6IHNob3dTdWJtaXQsCiAgICAgIHN1Ym1pdDogc3VibWl0LAogICAgICBsaXN0OiBsaXN0LAogICAgICBsb2FkaW5nOiBsb2FkaW5nLAogICAgICBzZWxlY3RlZERyczogc2VsZWN0ZWREcnMsCiAgICAgIGhlYWRlcnM6IFt7CiAgICAgICAgdGV4dDogJ0RhdGUnLAogICAgICAgIGFsaWduOiAnc3RhcnQnLAogICAgICAgIHNvcnRhYmxlOiBmYWxzZSwKICAgICAgICB2YWx1ZTogJ2NyZWF0ZWRfYXQnCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAnRFIgTm8nLAogICAgICAgIHZhbHVlOiAnc2FsZXNfZHJfbnVtYmVyJwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ0JhbGFuY2UnLAogICAgICAgIHZhbHVlOiAnYW1vdW50JwogICAgICB9XQogICAgfTsKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwFA,SACAA,QADA,EACAC,GADA,EACAC,KADA,EACAC,KADA,EAEAC,SAFA,EAEAC,WAFA,QAGA,sBAHA;AAIA;AACA;AAEA;EACAC,uBADA;EAEAC;IACAC;MACAC,YADA;MAEAC,cAFA;MAGAC;IAHA,CADA;IAMAC;MACAH,WADA;MAEAC,eAFA;MAGAC;IAHA;EANA,CAFA;EAcAE,KAdA,iBAcAN,KAdA,QAcA;IAAA;IACA;IACA;IACA;IACA;MAAA;IAAA;IACA;MAAA;IAAA;IACA;IACA;IACA;;IAEA;MACA;QACAO;QACAC;QAEA;MACA;;MAEAC;MACAF;MAEAG;QACAC;UAAA;;UACA;UAEA;;UAEA;YACAF;YACAF;UACA,CAHA,MAGA;YACAE;UACA;QACA,CAXA;MAYA,CAbA;MAeAD;IACA,CA3BA;;IA6BAX;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAe,iCADA;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;IAIAd;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAc,iCADA;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;IAIAhB;MACAgB;IACA,CAFA;;IAIA;MACAC;IACA,CAFA;;IAIA;MACAA;IACA,CAFA;;IAIA;MACAC,cADA;MAEAC,wBAFA;MAGAC,cAHA;MAIAC,sBAJA;MAKAC,cALA;MAMAP,UANA;MAOAQ,gBAPA;MAQAZ,wBARA;MASAa,UACA;QACAC,YADA;QAEAC,cAFA;QAGAC,eAHA;QAIAC;MAJA,CADA,EAOA;QAAAH;QAAAG;MAAA,CAPA,EAQA;QAAAH;QAAAG;MAAA,CARA;IATA;EAoBA;AA7FA","names":["computed","ref","toRef","watch","onMounted","onUnmounted","name","props","customerId","type","required","default","existingSelectedDr","setup","selectedDrs","store","listRecompute","existingSelectedDrs","list","reinitializeExistingSelectedDrs","emit","cancel","dateFormat1","search","showSubmit","submit","loading","headers","text","align","sortable","value"],"sourceRoot":"src/views/pages/sales/collections","sources":["DrListSelection.vue"],"sourcesContent":["<template>\n  <v-card class=\"pa-10\">\n    <v-card-text>\n      <v-row>\n        <v-col\n          cols=\"12\"\n          class=\"pa-16\"\n        >\n          <v-data-table\n            v-model=\"selectedDrs\"\n            :items=\"list\"\n            :headers=\"headers\"\n            show-select\n            :loading=\"loading\"\n            :search=\"search\"\n          >\n            <template v-slot:top>\n              <v-toolbar\n                color=\"info\"\n                outlined\n              >\n                <v-toolbar-title style=\"color: white\">\n                  Sales DR List\n                </v-toolbar-title>\n                <v-divider\n                  class=\"mx-4\"\n                  inset\n                  vertical\n                ></v-divider>\n                <v-spacer></v-spacer>\n                <v-text-field\n                  v-model=\"search\"\n                  append-icon=\"mdi-magnify\"\n                  label=\"Search\"\n                  single-line\n                  hide-details\n                  class=\"mr-4\"\n                ></v-text-field>\n              </v-toolbar>\n            </template>\n            <template #item.created_at=\"{ item }\">\n              {{ dateFormat1(item.created_at) }}\n            </template>\n            <template #item.amount=\"{ item }\">\n              <v-currency-field\n                v-model=\"item.amount\"\n                disabled\n                prefix=\"PHP\"\n                class=\"text-green\"\n              >\n              </v-currency-field>\n            </template>\n            <template #footer>\n              <v-row class=\"mb-2 mt-2\">\n                <v-col\n                  cols=\"8\"\n                ></v-col>\n                <v-col\n                  cols=\"2\"\n                >\n                  <v-btn\n                    color=\"error\"\n                    @click=\"cancel\"\n                  >\n                    Cancel\n                  </v-btn>\n                </v-col>\n                <v-col\n                  cols=\"1\"\n                >\n                  <v-btn\n                    color=\"info\"\n                    class=\"\"\n                    @click=\"submit\"\n                  >\n                    Submit\n                  </v-btn>\n                </v-col>\n              </v-row>\n            </template>\n          </v-data-table>\n        </v-col>\n      </v-row>\n    </v-card-text>\n  </v-card>\n</template>\n\n<script>\nimport {\n  computed, ref, toRef, watch,\n  onMounted, onUnmounted,\n} from '@vue/composition-api'\nimport store from '@/store'\nimport { dateFormat1 } from '@/utils/time'\n\nexport default {\n  name: 'DrListSelection',\n  props: {\n    customerId: {\n      type: Number,\n      required: true,\n      default: null,\n    },\n    existingSelectedDr: {\n      type: Array,\n      required: false,\n      default: null,\n    },\n  },\n  setup(props, { emit }) {\n    const customerIdData = toRef(props, 'customerId')\n    const existingSelectedDrs = toRef(props, 'existingSelectedDr')\n    const selectedDrs = ref([])\n    const list = computed(() => store.state.SalesDrStore.items)\n    const loading = computed(() => store.state.SalesDrStore.loading)\n    const showSubmit = ref(false)\n    const search = ref()\n    const listRecompute = ref([])\n\n    const reinitializeExistingSelectedDrs = () => {\n      if (existingSelectedDrs.value.length === 0) {\n        selectedDrs.value = []\n        store.dispatch('SalesDrStore/drListByCustomer', customerIdData.value)\n\n        return\n      }\n\n      listRecompute.value = []\n      selectedDrs.value = []\n\n      existingSelectedDrs.value.forEach(item => {\n        list.value.forEach(listItem => {\n          const id = item.sales_dr?.id ?? item.id\n\n          const exist = (listItem.id === id) ? listItem : false\n\n          if (exist) {\n            listRecompute.value.push(exist)\n            selectedDrs.value.push(exist)\n          } else {\n            listRecompute.value.push(listItem)\n          }\n        })\n      })\n\n      store.dispatch('SalesDrStore/updateOrderItems', listRecompute.value)\n    }\n\n    onMounted(async () => {\n      await reinitializeExistingSelectedDrs()\n    })\n\n    onUnmounted(async () => {\n      await reinitializeExistingSelectedDrs()\n    })\n\n    watch(existingSelectedDrs, () => {\n      reinitializeExistingSelectedDrs()\n    })\n\n    const submit = () => {\n      emit('selectedDrs', selectedDrs.value)\n    }\n\n    const cancel = () => {\n      emit('cancel')\n    }\n\n    return {\n      cancel,\n      dateFormat1,\n      search,\n      showSubmit,\n      submit,\n      list,\n      loading,\n      selectedDrs,\n      headers: [\n        {\n          text: 'Date',\n          align: 'start',\n          sortable: false,\n          value: 'created_at',\n        },\n        { text: 'DR No', value: 'sales_dr_number' },\n        { text: 'Balance', value: 'amount' },\n      ],\n    }\n  },\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}