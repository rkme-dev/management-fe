{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/thread-loader/dist/cjs.js!/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js!/Users/mark/projects/enco-fe/src/interceptors/axios.js","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/interceptors/axios.js","mtime":1655103817543},{"path":"/Users/mark/projects/enco-fe/babel.config.js","mtime":1654585219618},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/thread-loader/dist/cjs.js","mtime":1650363913040},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21hcmsvcHJvamVjdHMvZW5jby1mZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYXJrL3Byb2plY3RzL2VuY28tZmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwpheGlvcy5kZWZhdWx0cy5iYXNlVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3QvYXBpLyc7CmF4aW9zLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgcmV0dXJuIHJlc3BvbnNlOwp9LCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKGVycm9yKSB7CiAgICB2YXIgX3dpbmRvdyRsb2NhbFN0b3JhZ2UkOwoKICAgIHZhciBvcmlnaW5hbFJlcXVlc3QsIGFjY2Vzc1Rva2VuLCBfeWllbGQkYXhpb3MkcG9zdCwgc3RhdHVzLCBkYXRhOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgb3JpZ2luYWxSZXF1ZXN0ID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdvcmlnaW5hbF9yZXF1ZXN0Jyk7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gKF93aW5kb3ckbG9jYWxTdG9yYWdlJCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjZXNzX3Rva2VuJykpICE9PSBudWxsICYmIF93aW5kb3ckbG9jYWxTdG9yYWdlJCAhPT0gdm9pZCAwID8gX3dpbmRvdyRsb2NhbFN0b3JhZ2UkIDogbnVsbDsKCiAgICAgICAgICAgIGlmICghKGFjY2Vzc1Rva2VuID09PSBudWxsKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcjL2xvZ2luJzsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI1OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIGlmICghKGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDIyIHx8IGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNTAwKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgaWYgKCEoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MDEgJiYgb3JpZ2luYWxSZXF1ZXN0ID09PSB0cnVlKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEzOwogICAgICAgICAgICByZXR1cm4gYXhpb3MucG9zdCgncmVmcmVzaC10b2tlbicsIHsKICAgICAgICAgICAgICByZWZyZXNoX3Rva2VuOiB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JlZnJlc2hfdG9rZW4nKQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICBfeWllbGQkYXhpb3MkcG9zdCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIHN0YXR1cyA9IF95aWVsZCRheGlvcyRwb3N0LnN0YXR1czsKICAgICAgICAgICAgZGF0YSA9IF95aWVsZCRheGlvcyRwb3N0LmRhdGE7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnb3JpZ2luYWxfcmVxdWVzdCcsICdmYWxzZScpOwoKICAgICAgICAgICAgaWYgKCEoc3RhdHVzID09PSAyMDApKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjY2Vzc190b2tlbicsIGRhdGEuYWNjZXNzX3Rva2VuKTsKICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdyZWZyZXNoX3Rva2VuJywgZGF0YS5yZWZyZXNoX3Rva2VuKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbnNpc3RlbnQtcmV0dXJuCgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBheGlvcyhlcnJvci5jb25maWcpKTsKCiAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpOwogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcjL2xvZ2luJzsKCiAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBlcnJvcik7CgogICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CgogIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTs="},{"version":3,"names":["axios","defaults","baseURL","interceptors","response","use","error","originalRequest","window","localStorage","getItem","accessToken","location","href","status","post","refresh_token","data","setItem","access_token","config","clear"],"sources":["/Users/mark/projects/enco-fe/src/interceptors/axios.js"],"sourcesContent":["import axios from 'axios'\n\naxios.defaults.baseURL = 'http://localhost/api/'\n\naxios.interceptors.response.use(response => response, async error => {\n  const originalRequest = window.localStorage.getItem('original_request')\n  const accessToken = window.localStorage.getItem('access_token') ?? null\n\n  if (accessToken === null) {\n    window.location.href = '#/login'\n  } else if (error.response.status === 422 || error.response.status === 500) {\n    return\n  } else if (error.response.status === 401 && originalRequest === true) {\n    const { status, data } = await axios.post('refresh-token', {\n      refresh_token: window.localStorage.getItem('refresh_token'),\n    })\n\n    window.localStorage.setItem('original_request', 'false')\n\n    if (status === 200) {\n      window.localStorage.setItem('access_token', data.access_token)\n      window.localStorage.setItem('refresh_token', data.refresh_token)\n\n      // eslint-disable-next-line consistent-return\n      return axios(error.config)\n    }\n  } else {\n    localStorage.clear()\n    window.location.href = '#/login'\n  }\n\n  // eslint-disable-next-line consistent-return\n  return error\n})\n"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEAA,KAAK,CAACC,QAAN,CAAeC,OAAf,GAAyB,uBAAzB;AAEAF,KAAK,CAACG,YAAN,CAAmBC,QAAnB,CAA4BC,GAA5B,CAAgC,UAAAD,QAAQ;EAAA,OAAIA,QAAJ;AAAA,CAAxC;EAAA,sEAAsD,iBAAME,KAAN;IAAA;;IAAA;;IAAA;MAAA;QAAA;UAAA;YAC9CC,eAD8C,GAC5BC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,kBAA5B,CAD4B;YAE9CC,WAF8C,4BAEhCH,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,CAFgC,yEAEe,IAFf;;YAAA,MAIhDC,WAAW,KAAK,IAJgC;cAAA;cAAA;YAAA;;YAKlDH,MAAM,CAACI,QAAP,CAAgBC,IAAhB,GAAuB,SAAvB;YALkD;YAAA;;UAAA;YAAA,MAMzCP,KAAK,CAACF,QAAN,CAAeU,MAAf,KAA0B,GAA1B,IAAiCR,KAAK,CAACF,QAAN,CAAeU,MAAf,KAA0B,GANlB;cAAA;cAAA;YAAA;;YAAA;;UAAA;YAAA,MAQzCR,KAAK,CAACF,QAAN,CAAeU,MAAf,KAA0B,GAA1B,IAAiCP,eAAe,KAAK,IARZ;cAAA;cAAA;YAAA;;YAAA;YAAA,OASnBP,KAAK,CAACe,IAAN,CAAW,eAAX,EAA4B;cACzDC,aAAa,EAAER,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,eAA5B;YAD0C,CAA5B,CATmB;;UAAA;YAAA;YAS1CI,MAT0C,qBAS1CA,MAT0C;YASlCG,IATkC,qBASlCA,IATkC;YAalDT,MAAM,CAACC,YAAP,CAAoBS,OAApB,CAA4B,kBAA5B,EAAgD,OAAhD;;YAbkD,MAe9CJ,MAAM,KAAK,GAfmC;cAAA;cAAA;YAAA;;YAgBhDN,MAAM,CAACC,YAAP,CAAoBS,OAApB,CAA4B,cAA5B,EAA4CD,IAAI,CAACE,YAAjD;YACAX,MAAM,CAACC,YAAP,CAAoBS,OAApB,CAA4B,eAA5B,EAA6CD,IAAI,CAACD,aAAlD,EAjBgD,CAmBhD;;YAnBgD,iCAoBzChB,KAAK,CAACM,KAAK,CAACc,MAAP,CApBoC;;UAAA;YAAA;YAAA;;UAAA;YAuBlDX,YAAY,CAACY,KAAb;YACAb,MAAM,CAACI,QAAP,CAAgBC,IAAhB,GAAuB,SAAvB;;UAxBkD;YAAA,iCA4B7CP,KA5B6C;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAtD;;EAAA;IAAA;EAAA;AAAA"}]}