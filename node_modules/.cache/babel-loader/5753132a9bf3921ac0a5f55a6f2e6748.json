{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js!/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mark/projects/enco-fe/src/views/pages/user-access-management/users/UserAbilitiesForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/views/pages/user-access-management/users/UserAbilitiesForm.vue","mtime":1659098301276},{"path":"/Users/mark/projects/enco-fe/babel.config.js","mtime":1655991784146},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/vue-loader/lib/index.js","mtime":1650363919730}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21hcmsvcHJvamVjdHMvZW5jby1mZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYXJrL3Byb2plY3RzL2VuY28tZmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBtZGlBbGVydE91dGxpbmUsIG1kaUNsb3VkVXBsb2FkT3V0bGluZSwgbWRpSHVtYW5FZGl0IH0gZnJvbSAnQG1kaS9qcyc7CmltcG9ydCB7IHRvUmVmLCBvbk1vdW50ZWQsIHJlZiwgd2F0Y2ggfSBmcm9tICdAdnVlL2NvbXBvc2l0aW9uLWFwaSc7CmltcG9ydCByb3V0ZXIgZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZSc7CmltcG9ydCBVc2VyQWNjZXNzTWFuYWdlbWVudFNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL1VzZXJBY2Nlc3NNYW5hZ2VtZW50U2VydmljZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVXNlckFiaWxpdGllc0Zvcm1WdWUnLAogIHByb3BzOiB7CiAgICB1c2VyOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBsb2FkaW5nOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9CiAgfSwKICBzZXR1cDogZnVuY3Rpb24gc2V0dXAocHJvcHMsIF9yZWYpIHsKICAgIHZhciBlbWl0ID0gX3JlZi5lbWl0OwogICAgdmFyIHNlcnZpY2UgPSBuZXcgVXNlckFjY2Vzc01hbmFnZW1lbnRTZXJ2aWNlKCk7CiAgICB2YXIgdXNlckRhdGEgPSB0b1JlZihwcm9wcywgJ3VzZXInKTsKICAgIHZhciBhYmlsaXRpZXNPcHRpb25zID0gcmVmKFtdKTsKICAgIHZhciByb2xlT3B0aW9ucyA9IHJlZihbXSk7CiAgICB2YXIgYWJpbGl0aWVzU2VsZWN0ZWQgPSByZWYoW10pOwogICAgdmFyIGxvYWRpbmdMb2NhbGUgPSB0b1JlZihwcm9wcywgJ2xvYWRpbmcnKTsKICAgIHZhciBzaG93QWxlcnQgPSByZWYoZmFsc2UpOwogICAgdmFyIGxvYWRpbmdBYmlsaXRpZXMgPSByZWYodHJ1ZSk7CiAgICB3YXRjaCh1c2VyRGF0YSwgZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIGFiaWxpdGllc1NlbGVjdGVkLnZhbHVlID0gdmFsdWUuYWJpbGl0aWVzLm1hcChmdW5jdGlvbiAoYWJpbGl0eSkgewogICAgICAgIHJldHVybiBhYmlsaXR5LmlkOwogICAgICB9KTsKICAgIH0pOwogICAgb25Nb3VudGVkKCAvKiNfX1BVUkVfXyovX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIHNlcnZpY2UuZ2V0QWJpbGl0aWVzKHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBhYmlsaXRpZXNPcHRpb25zLnZhbHVlID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgICAgIGFiaWxpdGllc1NlbGVjdGVkLnZhbHVlID0gdXNlckRhdGEudmFsdWUuYWJpbGl0aWVzLm1hcChmdW5jdGlvbiAoYWJpbGl0eSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gYWJpbGl0eS5pZDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbG9hZGluZ0FiaWxpdGllcy52YWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgIHJldHVybiBzZXJ2aWNlLmdldFJvbGVzKHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICByb2xlT3B0aW9ucy52YWx1ZSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpKTsKCiAgICB2YXIgZ29CYWNrID0gZnVuY3Rpb24gZ29CYWNrKCkgewogICAgICByb3V0ZXIucHVzaCgnL3VzZXJzJyk7CiAgICB9OwoKICAgIHZhciBzdWJtaXQgPSBmdW5jdGlvbiBzdWJtaXQoKSB7CiAgICAgIHN0b3JlLmRpc3BhdGNoKCdVc2VyQWNjZXNzTWFuYWdlbWVudFN0b3JlL3VwZGF0ZVVzZXInLCB7CiAgICAgICAgcm9sZV9pZDogdXNlckRhdGEudmFsdWUucm9sZV9pZCwKICAgICAgICBhYmlsaXRpZXM6IGFiaWxpdGllc1NlbGVjdGVkLnZhbHVlLAogICAgICAgIGlkOiB1c2VyRGF0YS52YWx1ZS5pZAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgc2hvd0FsZXJ0LnZhbHVlID0gdHJ1ZTsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzaG93QWxlcnQudmFsdWUgPSBmYWxzZTsKICAgICAgICAgIH0sIDE1MDApOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgIGFiaWxpdGllc09wdGlvbnM6IGFiaWxpdGllc09wdGlvbnMsCiAgICAgIGFiaWxpdGllc1NlbGVjdGVkOiBhYmlsaXRpZXNTZWxlY3RlZCwKICAgICAgbG9hZGluZ0FiaWxpdGllczogbG9hZGluZ0FiaWxpdGllcywKICAgICAgbG9hZGluZ0xvY2FsZTogbG9hZGluZ0xvY2FsZSwKICAgICAgaWNvbnM6IHsKICAgICAgICBtZGlBbGVydE91dGxpbmU6IG1kaUFsZXJ0T3V0bGluZSwKICAgICAgICBtZGlDbG91ZFVwbG9hZE91dGxpbmU6IG1kaUNsb3VkVXBsb2FkT3V0bGluZSwKICAgICAgICBtZGlIdW1hbkVkaXQ6IG1kaUh1bWFuRWRpdAogICAgICB9LAogICAgICBnb0JhY2s6IGdvQmFjaywKICAgICAgcm9sZU9wdGlvbnM6IHJvbGVPcHRpb25zLAogICAgICBzaG93QWxlcnQ6IHNob3dBbGVydCwKICAgICAgc3VibWl0OiBzdWJtaXQsCiAgICAgIHVzZXJEYXRhOiB1c2VyRGF0YQogICAgfTsKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiFA;AACA,SACAA,KADA,EAEAC,SAFA,EAGAC,GAHA,EAIAC,KAJA,QAKA,sBALA;AAMA;AACA;AACA;AAEA;EACAC,4BADA;EAEAC;IACAC;MACAC,YADA;MAEAC;IAFA,CADA;IAKAC;MACAF,aADA;MAEAG,aAFA;MAGAF;IAHA;EALA,CAFA;EAaAG,KAbA,iBAaAN,KAbA,QAaA;IAAA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEAF;MACAS;QAAA;MAAA;IACA,CAFA;IAIAX;MAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAY,2BACAC,IADA,CACA;gBACAC;gBACAH;kBAAA;gBAAA;gBACAI;cACA,CALA,CADA;;YAAA;cAAA;cAAA,OAQAH,uBACAC,IADA,CACA;gBACAG;cACA,CAHA,CARA;;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;;IAcA;MACAC;IACA,CAFA;;IAIA;MACAC;QACAC,+BADA;QAEAC,kCAFA;QAGAC;MAHA,GAIAR,IAJA,CAKA;QACA;UACAS;UACAC;YACAD;UACA,CAFA,EAEA,IAFA;QAGA;MACA,CAZA;IAcA,CAfA;;IAiBA;MACAR,kCADA;MAEAH,oCAFA;MAGAI,kCAHA;MAIAS,4BAJA;MAKAC;QACAC,gCADA;QAEAC,4CAFA;QAGAC;MAHA,CALA;MAUAC,cAVA;MAWAb,wBAXA;MAYAM,oBAZA;MAaAQ,cAbA;MAcAC;IAdA;EAgBA;AA9EA","names":["toRef","onMounted","ref","watch","name","props","user","type","required","loading","default","setup","abilitiesSelected","service","then","abilitiesOptions","loadingAbilities","roleOptions","router","store","role_id","abilities","id","showAlert","setTimeout","loadingLocale","icons","mdiAlertOutline","mdiCloudUploadOutline","mdiHumanEdit","goBack","submit","userData"],"sourceRoot":"src/views/pages/user-access-management/users","sources":["UserAbilitiesForm.vue"],"sourcesContent":["<template>\n  <v-card\n    flat\n    class=\"pa-3 mt-2\"\n  >\n    <v-alert\n      dense\n      text\n      type=\"success\"\n      v-show=\"showAlert\"\n      dismissible\n    >\n      Successfully updated\n    </v-alert>\n    <v-card-text>\n      <v-progress-linear\n        v-if=\"loadingLocale || loadingAbilities\"\n        indeterminate\n        color=\"primary\"\n      ></v-progress-linear>\n      <v-form\n        v-if=\"!loadingLocale && !loadingAbilities\"\n        class=\"multi-col-validation mt-6\"\n      >\n        <v-row>\n          <v-col\n            cols=\"12\"\n            md=\"6\"\n          >\n            <v-select\n              v-model=\"userData.role_id\"\n              dense\n              outlined\n              :prepend-inner-icon=\"icons.mdiHumanEdit\"\n              item-text=\"title\"\n              item-value=\"id\"\n              label=\"Role\"\n              :items=\"roleOptions\"\n            ></v-select>\n          </v-col>\n\n          <v-col\n            cols=\"12\"\n            md=\"9\"\n          >\n            <v-treeview\n              v-model=\"abilitiesSelected\"\n              selectable\n              selected-color=\"primary\"\n              item-disabled=\"locked\"\n              item-key=\"id\"\n              item-text=\"name\"\n              item-children=\"abilities\"\n              :items=\"abilitiesOptions\"\n            ></v-treeview>\n          </v-col>\n\n          <v-col cols=\"12\">\n            <v-btn\n              color=\"primary\"\n              class=\"me-3 mt-4\"\n              @click=\"submit\"\n            >\n              Save changes\n            </v-btn>\n            <v-btn\n              color=\"info\"\n              outlined\n              class=\"mt-3\"\n              type=\"reset\"\n              @click.prevent=\"goBack\"\n            >\n              Back to Users Page\n            </v-btn>\n          </v-col>\n        </v-row>\n      </v-form>\n    </v-card-text>\n  </v-card>\n</template>\n<script>\nimport { mdiAlertOutline, mdiCloudUploadOutline, mdiHumanEdit } from '@mdi/js'\nimport {\n  toRef,\n  onMounted,\n  ref,\n  watch\n} from '@vue/composition-api'\nimport router from '@/router'\nimport store from '@/store'\nimport UserAccessManagementService from '@/service/UserAccessManagementService'\n\nexport default {\n  name: 'UserAbilitiesFormVue',\n  props: {\n    user: {\n      type: Object,\n      required: true,\n    },\n    loading: {\n      type: Boolean,\n      default: true,\n      required: true,\n    },\n  },\n  setup(props, { emit }) {\n    const service = new UserAccessManagementService()\n    const userData = toRef(props, 'user')\n    const abilitiesOptions = ref([])\n    const roleOptions = ref([])\n    const abilitiesSelected = ref([])\n    const loadingLocale = toRef(props, 'loading')\n    const showAlert = ref(false)\n    const loadingAbilities = ref(true)\n\n    watch(userData, value => {\n      abilitiesSelected.value = value.abilities.map(ability => ability.id)\n    })\n\n    onMounted(async () => {\n      await service.getAbilities(true)\n        .then(response => {\n          abilitiesOptions.value = response.data\n          abilitiesSelected.value = userData.value.abilities.map(ability => ability.id)\n          loadingAbilities.value = false\n        })\n\n      await service.getRoles(true)\n        .then(response => {\n          roleOptions.value = response.data\n        })\n    })\n\n    const goBack = () => {\n      router.push('/users')\n    }\n\n    const submit = () => {\n      store.dispatch('UserAccessManagementStore/updateUser', {\n        role_id: userData.value.role_id,\n        abilities: abilitiesSelected.value,\n        id: userData.value.id,\n      }).then(\n        response => {\n          if (response.status === undefined) {\n            showAlert.value = true\n            setTimeout(() => {\n              showAlert.value = false\n            }, 1500)\n          }\n        },\n      )\n    }\n\n    return {\n      abilitiesOptions,\n      abilitiesSelected,\n      loadingAbilities,\n      loadingLocale,\n      icons: {\n        mdiAlertOutline,\n        mdiCloudUploadOutline,\n        mdiHumanEdit,\n      },\n      goBack,\n      roleOptions,\n      showAlert,\n      submit,\n      userData,\n    }\n  },\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}