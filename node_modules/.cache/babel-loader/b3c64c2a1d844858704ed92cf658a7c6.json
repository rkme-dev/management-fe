{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js!/Users/mark/projects/enco-fe/src/interceptors/axios.js","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/interceptors/axios.js","mtime":1655991452665},{"path":"/Users/mark/projects/enco-fe/babel.config.js","mtime":1655991784146},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21hcmsvcHJvamVjdHMvZW5jby1mZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYXJrL3Byb2plY3RzL2VuY28tZmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwpheGlvcy5kZWZhdWx0cy5iYXNlVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3QvYXBpLyc7CmF4aW9zLmludGVyY2VwdG9ycy5yZXNwb25zZS51c2UoZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgcmV0dXJuIHJlc3BvbnNlOwp9LCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKGVycm9yKSB7CiAgICB2YXIgb3JpZ2luYWxSZXF1ZXN0LCBhY2Nlc3NUb2tlbiwgX3lpZWxkJGF4aW9zJHBvc3QsIHN0YXR1cywgZGF0YTsKCiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIG9yaWdpbmFsUmVxdWVzdCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnb3JpZ2luYWxfcmVxdWVzdCcpOwogICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjZXNzX3Rva2VuJykgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY2Vzc190b2tlbicpOwoKICAgICAgICAgICAgaWYgKCEoYWNjZXNzVG9rZW4gPT09IG51bGwpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJyMvbG9naW4nOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjU7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgaWYgKCEoZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA0MjIgfHwgZXJyb3IucmVzcG9uc2Uuc3RhdHVzID09PSA1MDApKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICBpZiAoIShlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwMSAmJiBvcmlnaW5hbFJlcXVlc3QgPT09IHRydWUpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIzOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KCdyZWZyZXNoLXRva2VuJywgewogICAgICAgICAgICAgIHJlZnJlc2hfdG9rZW46IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncmVmcmVzaF90b2tlbicpCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIF95aWVsZCRheGlvcyRwb3N0ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgc3RhdHVzID0gX3lpZWxkJGF4aW9zJHBvc3Quc3RhdHVzOwogICAgICAgICAgICBkYXRhID0gX3lpZWxkJGF4aW9zJHBvc3QuZGF0YTsKICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdvcmlnaW5hbF9yZXF1ZXN0JywgJ2ZhbHNlJyk7CgogICAgICAgICAgICBpZiAoIShzdGF0dXMgPT09IDIwMCkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWNjZXNzX3Rva2VuJywgZGF0YS5hY2Nlc3NfdG9rZW4pOwogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3JlZnJlc2hfdG9rZW4nLCBkYXRhLnJlZnJlc2hfdG9rZW4pOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29uc2lzdGVudC1yZXR1cm4KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGF4aW9zKGVycm9yLmNvbmZpZykpOwoKICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJyMvbG9naW4nOwoKICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGVycm9yKTsKCiAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOw=="},{"version":3,"names":["axios","defaults","baseURL","interceptors","response","use","error","originalRequest","window","localStorage","getItem","accessToken","undefined","location","href","status","post","refresh_token","data","setItem","access_token","config","clear"],"sources":["/Users/mark/projects/enco-fe/src/interceptors/axios.js"],"sourcesContent":["import axios from 'axios'\n\naxios.defaults.baseURL = 'http://localhost/api/'\n\naxios.interceptors.response.use(response => response, async error => {\n  const originalRequest = window.localStorage.getItem('original_request')\n  const accessToken = window.localStorage.getItem('access_token') === undefined ? null : window.localStorage.getItem('access_token')\n\n  if (accessToken === null) {\n    window.location.href = '#/login'\n  } else if (error.response.status === 422 || error.response.status === 500) {\n    return\n  } else if (error.response.status === 401 && originalRequest === true) {\n    const { status, data } = await axios.post('refresh-token', {\n      refresh_token: window.localStorage.getItem('refresh_token'),\n    })\n\n    window.localStorage.setItem('original_request', 'false')\n\n    if (status === 200) {\n      window.localStorage.setItem('access_token', data.access_token)\n      window.localStorage.setItem('refresh_token', data.refresh_token)\n\n      // eslint-disable-next-line consistent-return\n      return axios(error.config)\n    }\n  } else {\n    localStorage.clear()\n    window.location.href = '#/login'\n  }\n\n  // eslint-disable-next-line consistent-return\n  return error\n})\n"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEAA,KAAK,CAACC,QAAN,CAAeC,OAAf,GAAyB,uBAAzB;AAEAF,KAAK,CAACG,YAAN,CAAmBC,QAAnB,CAA4BC,GAA5B,CAAgC,UAAAD,QAAQ;EAAA,OAAIA,QAAJ;AAAA,CAAxC;EAAA,sEAAsD,iBAAME,KAAN;IAAA;;IAAA;MAAA;QAAA;UAAA;YAC9CC,eAD8C,GAC5BC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,kBAA5B,CAD4B;YAE9CC,WAF8C,GAEhCH,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,MAAgDE,SAAhD,GAA4D,IAA5D,GAAmEJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,CAFnC;;YAAA,MAIhDC,WAAW,KAAK,IAJgC;cAAA;cAAA;YAAA;;YAKlDH,MAAM,CAACK,QAAP,CAAgBC,IAAhB,GAAuB,SAAvB;YALkD;YAAA;;UAAA;YAAA,MAMzCR,KAAK,CAACF,QAAN,CAAeW,MAAf,KAA0B,GAA1B,IAAiCT,KAAK,CAACF,QAAN,CAAeW,MAAf,KAA0B,GANlB;cAAA;cAAA;YAAA;;YAAA;;UAAA;YAAA,MAQzCT,KAAK,CAACF,QAAN,CAAeW,MAAf,KAA0B,GAA1B,IAAiCR,eAAe,KAAK,IARZ;cAAA;cAAA;YAAA;;YAAA;YAAA,OASnBP,KAAK,CAACgB,IAAN,CAAW,eAAX,EAA4B;cACzDC,aAAa,EAAET,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,eAA5B;YAD0C,CAA5B,CATmB;;UAAA;YAAA;YAS1CK,MAT0C,qBAS1CA,MAT0C;YASlCG,IATkC,qBASlCA,IATkC;YAalDV,MAAM,CAACC,YAAP,CAAoBU,OAApB,CAA4B,kBAA5B,EAAgD,OAAhD;;YAbkD,MAe9CJ,MAAM,KAAK,GAfmC;cAAA;cAAA;YAAA;;YAgBhDP,MAAM,CAACC,YAAP,CAAoBU,OAApB,CAA4B,cAA5B,EAA4CD,IAAI,CAACE,YAAjD;YACAZ,MAAM,CAACC,YAAP,CAAoBU,OAApB,CAA4B,eAA5B,EAA6CD,IAAI,CAACD,aAAlD,EAjBgD,CAmBhD;;YAnBgD,iCAoBzCjB,KAAK,CAACM,KAAK,CAACe,MAAP,CApBoC;;UAAA;YAAA;YAAA;;UAAA;YAuBlDZ,YAAY,CAACa,KAAb;YACAd,MAAM,CAACK,QAAP,CAAgBC,IAAhB,GAAuB,SAAvB;;UAxBkD;YAAA,iCA4B7CR,KA5B6C;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAtD;;EAAA;IAAA;EAAA;AAAA"}]}