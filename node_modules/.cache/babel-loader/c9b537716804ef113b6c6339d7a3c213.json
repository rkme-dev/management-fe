{"remainingRequest":"/Users/mark/projects/enco-fe/node_modules/thread-loader/dist/cjs.js!/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js!/Users/mark/projects/enco-fe/src/interceptors/axios.js","dependencies":[{"path":"/Users/mark/projects/enco-fe/src/interceptors/axios.js","mtime":1659511185559},{"path":"/Users/mark/projects/enco-fe/babel.config.js","mtime":1655991784146},{"path":"/Users/mark/projects/enco-fe/node_modules/cache-loader/dist/cjs.js","mtime":1650363912993},{"path":"/Users/mark/projects/enco-fe/node_modules/thread-loader/dist/cjs.js","mtime":1650363913040},{"path":"/Users/mark/projects/enco-fe/node_modules/babel-loader/lib/index.js","mtime":1652172763063}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21hcmsvcHJvamVjdHMvZW5jby1mZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9tYXJrL3Byb2plY3RzL2VuY28tZmUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwpheGlvcy5kZWZhdWx0cy5iYXNlVVJMID0gJ2h0dHA6Ly9lbmNvLmFwaS9hcGkvJzsKYXhpb3MuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICByZXR1cm4gcmVzcG9uc2U7Cn0sIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZXJyb3IpIHsKICAgIHZhciBvcmlnaW5hbFJlcXVlc3QsIGFjY2Vzc1Rva2VuLCBfeWllbGQkYXhpb3MkcG9zdCwgc3RhdHVzLCBkYXRhOwoKICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgb3JpZ2luYWxSZXF1ZXN0ID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdvcmlnaW5hbF9yZXF1ZXN0Jyk7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2Nlc3NfdG9rZW4nKSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjZXNzX3Rva2VuJyk7CgogICAgICAgICAgICBpZiAoIShhY2Nlc3NUb2tlbiA9PT0gbnVsbCkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnIy9sb2dpbic7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNTsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBpZiAoIShlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQyMiB8fCBlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDUwMCkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIGlmICghKGVycm9yLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxICYmIG9yaWdpbmFsUmVxdWVzdCA9PT0gdHJ1ZSkpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QoJ3JlZnJlc2gtdG9rZW4nLCB7CiAgICAgICAgICAgICAgcmVmcmVzaF90b2tlbjogd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdyZWZyZXNoX3Rva2VuJykKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgX3lpZWxkJGF4aW9zJHBvc3QgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICBzdGF0dXMgPSBfeWllbGQkYXhpb3MkcG9zdC5zdGF0dXM7CiAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkYXhpb3MkcG9zdC5kYXRhOwogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ29yaWdpbmFsX3JlcXVlc3QnLCAnZmFsc2UnKTsKCiAgICAgICAgICAgIGlmICghKHN0YXR1cyA9PT0gMjAwKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY2Nlc3NfdG9rZW4nLCBkYXRhLmFjY2Vzc190b2tlbik7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncmVmcmVzaF90b2tlbicsIGRhdGEucmVmcmVzaF90b2tlbik7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb25zaXN0ZW50LXJldHVybgoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgYXhpb3MoZXJyb3IuY29uZmlnKSk7CgogICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI1OwogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnIy9sb2dpbic7CgogICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgZXJyb3IpOwoKICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7"},{"version":3,"names":["axios","defaults","baseURL","interceptors","response","use","error","originalRequest","window","localStorage","getItem","accessToken","undefined","location","href","status","post","refresh_token","data","setItem","access_token","config","clear"],"sources":["/Users/mark/projects/enco-fe/src/interceptors/axios.js"],"sourcesContent":["import axios from 'axios'\n\naxios.defaults.baseURL = 'http://enco.api/api/'\n\naxios.interceptors.response.use(response => response, async error => {\n  const originalRequest = window.localStorage.getItem('original_request')\n  const accessToken = window.localStorage.getItem('access_token') === undefined ? null : window.localStorage.getItem('access_token')\n\n  if (accessToken === null) {\n    window.location.href = '#/login'\n  } else if (error.response.status === 422 || error.response.status === 500) {\n    return\n  } else if (error.response.status === 401 && originalRequest === true) {\n    const { status, data } = await axios.post('refresh-token', {\n      refresh_token: window.localStorage.getItem('refresh_token'),\n    })\n\n    window.localStorage.setItem('original_request', 'false')\n\n    if (status === 200) {\n      window.localStorage.setItem('access_token', data.access_token)\n      window.localStorage.setItem('refresh_token', data.refresh_token)\n\n      // eslint-disable-next-line consistent-return\n      return axios(error.config)\n    }\n  } else {\n    localStorage.clear()\n    window.location.href = '#/login'\n  }\n\n  // eslint-disable-next-line consistent-return\n  return error\n})\n"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEAA,KAAK,CAACC,QAAN,CAAeC,OAAf,GAAyB,sBAAzB;AAEAF,KAAK,CAACG,YAAN,CAAmBC,QAAnB,CAA4BC,GAA5B,CAAgC,UAAAD,QAAQ;EAAA,OAAIA,QAAJ;AAAA,CAAxC;EAAA,sEAAsD,iBAAME,KAAN;IAAA;;IAAA;MAAA;QAAA;UAAA;YAC9CC,eAD8C,GAC5BC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,kBAA5B,CAD4B;YAE9CC,WAF8C,GAEhCH,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,MAAgDE,SAAhD,GAA4D,IAA5D,GAAmEJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,CAFnC;;YAAA,MAIhDC,WAAW,KAAK,IAJgC;cAAA;cAAA;YAAA;;YAKlDH,MAAM,CAACK,QAAP,CAAgBC,IAAhB,GAAuB,SAAvB;YALkD;YAAA;;UAAA;YAAA,MAMzCR,KAAK,CAACF,QAAN,CAAeW,MAAf,KAA0B,GAA1B,IAAiCT,KAAK,CAACF,QAAN,CAAeW,MAAf,KAA0B,GANlB;cAAA;cAAA;YAAA;;YAAA;;UAAA;YAAA,MAQzCT,KAAK,CAACF,QAAN,CAAeW,MAAf,KAA0B,GAA1B,IAAiCR,eAAe,KAAK,IARZ;cAAA;cAAA;YAAA;;YAAA;YAAA,OASnBP,KAAK,CAACgB,IAAN,CAAW,eAAX,EAA4B;cACzDC,aAAa,EAAET,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,eAA5B;YAD0C,CAA5B,CATmB;;UAAA;YAAA;YAS1CK,MAT0C,qBAS1CA,MAT0C;YASlCG,IATkC,qBASlCA,IATkC;YAalDV,MAAM,CAACC,YAAP,CAAoBU,OAApB,CAA4B,kBAA5B,EAAgD,OAAhD;;YAbkD,MAe9CJ,MAAM,KAAK,GAfmC;cAAA;cAAA;YAAA;;YAgBhDP,MAAM,CAACC,YAAP,CAAoBU,OAApB,CAA4B,cAA5B,EAA4CD,IAAI,CAACE,YAAjD;YACAZ,MAAM,CAACC,YAAP,CAAoBU,OAApB,CAA4B,eAA5B,EAA6CD,IAAI,CAACD,aAAlD,EAjBgD,CAmBhD;;YAnBgD,iCAoBzCjB,KAAK,CAACM,KAAK,CAACe,MAAP,CApBoC;;UAAA;YAAA;YAAA;;UAAA;YAuBlDZ,YAAY,CAACa,KAAb;YACAd,MAAM,CAACK,QAAP,CAAgBC,IAAhB,GAAuB,SAAvB;;UAxBkD;YAAA,iCA4B7CR,KA5B6C;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAtD;;EAAA;IAAA;EAAA;AAAA"}]}